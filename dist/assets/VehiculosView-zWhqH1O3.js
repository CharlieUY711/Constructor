import{e as D,p as E,r as n,j as e,g as W,T as P,t as l}from"./index-iDsHFp5u.js";import{O as $}from"./OrangeHeader-DiDrEgeU.js";import{P as L}from"./plus-Ca2_lTPI.js";import{L as N}from"./loader-circle-Btlfs3PV.js";import{P as I}from"./pen-C6YjlKXS.js";import{T as O}from"./trash-2-BgYZWFt7.js";import"./ConnectionStatusIcon-Jdy9-hf6.js";import"./zap-CPJ7bT-6.js";import"./lightbulb-BEmDgyfr.js";import"./map-pin-C2SMsNoE.js";const V=`${D}/vehiculos`,_="oddy",q={"Content-Type":"application/json",Authorization:`Bearer ${E}`,apikey:E,"x-tenant-id":_};async function h(i,a){const d=await(await fetch(`${V}${i}`,{headers:q,...a})).json();if(d.error)throw new Error(d.error);return d}async function G(i){const a=new URLSearchParams;return(await h(a.toString()?`?${a}`:"")).data||[]}async function M(i){return(await h("",{method:"POST",body:JSON.stringify(i)})).data||null}async function H(i,a){return(await h(`/${i}`,{method:"PUT",body:JSON.stringify(a)})).data||null}async function U(i){try{return await h(`/${i}`,{method:"DELETE"}),!0}catch{return!1}}const b="#FF6835",x={moto:{label:"Moto",emoji:"ðŸï¸"},auto:{label:"Auto",emoji:"ðŸš—"},furgon:{label:"FurgÃ³n",emoji:"ðŸš"},camioneta:{label:"Camioneta",emoji:"ðŸ›»"},camion:{label:"CamiÃ³n",emoji:"ðŸšš"}},z={tipo:"moto",activo:!0};function ae({onNavigate:i}){const[a,p]=n.useState([]),[d,j]=n.useState(!0),[u,C]=n.useState(""),[r,c]=n.useState(z),[m,k]=n.useState(null),[w,g]=n.useState(!1),[y,S]=n.useState(!1),f=async()=>{j(!0);try{p(await G())}catch{l.error("Error cargando vehÃ­culos")}finally{j(!1)}};n.useEffect(()=>{f()},[]);const v=a.filter(t=>t.patente.toLowerCase().includes(u.toLowerCase())||(t.marca||"").toLowerCase().includes(u.toLowerCase())),A=()=>{c(z),k(null),g(!0)},B=t=>{c(t),k(t.id),g(!0)},F=async()=>{if(!r.patente||!r.tipo)return l.error("Patente y tipo son requeridos");S(!0);try{m?(await H(m,r),l.success("VehÃ­culo actualizado")):(await M(r),l.success("VehÃ­culo creado")),g(!1),f()}catch{l.error("Error guardando")}finally{S(!1)}},T=async t=>{confirm("Â¿Eliminar vehÃ­culo?")&&(await U(t),l.success("Eliminado"),f())};return e.jsxs("div",{style:{minHeight:"100vh",background:"#F8FAFC"},children:[e.jsx($,{title:"VehÃ­culos",subtitle:"Flota propia y de transportistas",onBack:()=>i("logistica")}),e.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:"24px 16px"},children:[e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:24},children:[e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx(W,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9CA3AF"}}),e.jsx("input",{value:u,onChange:t=>C(t.target.value),placeholder:"Buscar por patente o marca...",style:{width:"100%",paddingLeft:36,paddingRight:12,paddingTop:10,paddingBottom:10,border:"1px solid #E5E7EB",borderRadius:8,fontSize:14,boxSizing:"border-box"}})]}),e.jsxs("button",{onClick:A,style:{display:"flex",alignItems:"center",gap:6,background:b,color:"#fff",border:"none",borderRadius:8,padding:"10px 18px",fontWeight:600,cursor:"pointer",fontSize:14},children:[e.jsx(L,{size:16})," Nuevo"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:12,marginBottom:24},children:Object.entries(x).map(([t,o])=>{const s=a.filter(R=>R.tipo===t).length;return e.jsxs("div",{style:{background:"#fff",border:"1px solid #E5E7EB",borderRadius:10,padding:"14px 16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24},children:o.emoji}),e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#111"},children:s}),e.jsx("div",{style:{fontSize:12,color:"#6B7280"},children:o.label})]},t)})}),d?e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx(N,{size:32,style:{color:b,animation:"spin 1s linear infinite"}})}):v.length===0?e.jsxs("div",{style:{textAlign:"center",padding:60,color:"#9CA3AF"},children:[e.jsx(P,{size:48,style:{marginBottom:12,opacity:.3}}),e.jsxs("p",{children:["No hay vehÃ­culos",u?" que coincidan":". AgregÃ¡ el primero."]})]}):e.jsx("div",{style:{display:"grid",gap:10},children:v.map(t=>{var o,s;return e.jsxs("div",{style:{background:"#fff",border:"1px solid #E5E7EB",borderRadius:10,padding:"16px 20px",display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{style:{fontSize:28,minWidth:40,textAlign:"center"},children:((o=x[t.tipo])==null?void 0:o.emoji)||"ðŸš—"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:700,fontSize:16},children:t.patente}),e.jsxs("div",{style:{fontSize:13,color:"#6B7280"},children:[(s=x[t.tipo])==null?void 0:s.label," ",t.marca&&`Â· ${t.marca}`," ",t.modelo&&t.modelo," ",t.anio&&`(${t.anio})`]}),(t.capacidad_kg||t.capacidad_m3)&&e.jsxs("div",{style:{fontSize:12,color:"#9CA3AF",marginTop:2},children:[t.capacidad_kg&&`${t.capacidad_kg} kg`," ",t.capacidad_m3&&`Â· ${t.capacidad_m3} mÂ³`]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[t.activo?e.jsx("span",{style:{background:"#ECFDF5",color:"#059669",fontSize:12,fontWeight:600,padding:"3px 10px",borderRadius:20},children:"Activo"}):e.jsx("span",{style:{background:"#F3F4F6",color:"#6B7280",fontSize:12,fontWeight:600,padding:"3px 10px",borderRadius:20},children:"Inactivo"}),e.jsx("button",{onClick:()=>B(t),style:{background:"none",border:"none",cursor:"pointer",color:"#6B7280",padding:6},children:e.jsx(I,{size:15})}),e.jsx("button",{onClick:()=>T(t.id),style:{background:"none",border:"none",cursor:"pointer",color:"#EF4444",padding:6},children:e.jsx(O,{size:15})})]})]},t.id)})})]}),w&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:16},children:e.jsxs("div",{style:{background:"#fff",borderRadius:14,padding:28,width:"100%",maxWidth:480},children:[e.jsx("h3",{style:{margin:"0 0 20px",fontSize:18,fontWeight:700},children:m?"Editar vehÃ­culo":"Nuevo vehÃ­culo"}),e.jsxs("div",{style:{display:"grid",gap:14},children:[[{key:"patente",label:"Patente *",type:"text"},{key:"marca",label:"Marca",type:"text"},{key:"modelo",label:"Modelo",type:"text"},{key:"anio",label:"AÃ±o",type:"number"},{key:"capacidad_kg",label:"Capacidad (kg)",type:"number"},{key:"capacidad_m3",label:"Capacidad (mÂ³)",type:"number"}].map(t=>e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:t.label}),e.jsx("input",{type:t.type,value:r[t.key]||"",onChange:o=>c(s=>({...s,[t.key]:t.type==="number"?Number(o.target.value):o.target.value})),style:{width:"100%",border:"1px solid #D1D5DB",borderRadius:8,padding:"9px 12px",fontSize:14,boxSizing:"border-box"}})]},t.key)),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Tipo *"}),e.jsx("select",{value:r.tipo||"moto",onChange:t=>c(o=>({...o,tipo:t.target.value})),style:{width:"100%",border:"1px solid #D1D5DB",borderRadius:8,padding:"9px 12px",fontSize:14},children:Object.entries(x).map(([t,o])=>e.jsxs("option",{value:t,children:[o.emoji," ",o.label]},t))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:r.activo??!0,onChange:t=>c(o=>({...o,activo:t.target.checked}))}),e.jsx("span",{style:{fontSize:14},children:"Activo"})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,marginTop:22,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>g(!1),style:{padding:"9px 18px",border:"1px solid #D1D5DB",borderRadius:8,background:"#fff",cursor:"pointer",fontSize:14},children:"Cancelar"}),e.jsx("button",{onClick:F,disabled:y,style:{padding:"9px 18px",background:b,color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer",fontSize:14,opacity:y?.7:1},children:y?"Guardando...":"Guardar"})]})]})})]})}export{ae as VehiculosView};
