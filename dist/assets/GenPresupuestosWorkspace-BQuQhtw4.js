import{r as j,j as e}from"./index-CzcvZDmw.js";import{W as R}from"./WorkspaceShell-FyNMqd6a.js";import{D as z}from"./download-1K8-XJUC.js";import{F as T}from"./file-text-AwnvgzQt.js";import{T as P}from"./trash-2-C9nG65gh.js";import{P as $}from"./plus-4d6aYh60.js";import"./arrow-left-DMksOhr_.js";import"./printer-BgnN-lvJ.js";const B=[{id:"UYU",symbol:"$U",label:"Peso Uruguayo"},{id:"USD",symbol:"US$",label:"Dólar Americano"},{id:"EUR",symbol:"€",label:"Euro"},{id:"ARS",symbol:"$",label:"Peso Argentino"}],C={draft:{label:"Borrador",color:"#9CA3AF",bg:"#F3F4F6"},sent:{label:"Enviado",color:"#3B82F6",bg:"#EFF6FF"},approved:{label:"Aprobado",color:"#10B981",bg:"#D1FAE5"},rejected:{label:"Rechazado",color:"#EF4444",bg:"#FEF2F2"}};function A(){return{id:`item-${Date.now()}-${Math.random().toString(36).slice(2)}`,description:"",qty:1,unitPrice:0,discount:0}}function S(p,n){return`${n} ${p.toLocaleString("es-UY",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function U({quoteNumber:p,currency:n,setCurrency:g,iva:a,setIva:u,globalDiscount:l,setGlobalDiscount:r,status:x,setStatus:h,validDays:i,setValidDays:c,client:m,setClient:f}){return B.find(o=>o.id===n),e.jsxs("div",{style:{padding:"10px 12px",overflowY:"auto",height:"100%"},children:[e.jsx("p",{style:F,children:"Documento"}),e.jsxs("div",{style:{marginBottom:8,padding:"8px 10px",backgroundColor:"#FFFBEB",borderRadius:7,border:"1px solid #FDE68A"},children:[e.jsxs("div",{style:{fontSize:"0.65rem",color:"#92400E",fontWeight:"700"},children:["Nº ",p]}),e.jsx("div",{style:{fontSize:"0.62rem",color:"#9CA3AF"},children:new Date().toLocaleDateString("es-UY",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("p",{style:F,children:"Estado"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:10},children:Object.keys(C).map(o=>{const s=C[o];return e.jsx("button",{onClick:()=>h(o),style:{padding:"3px 8px",borderRadius:5,border:`1.5px solid ${x===o?s.color:"#E5E7EB"}`,backgroundColor:x===o?s.bg:"#fff",color:x===o?s.color:"#9CA3AF",cursor:"pointer",fontSize:"0.63rem",fontWeight:"700"},children:s.label},o)})}),e.jsx("p",{style:F,children:"Validez (días)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:10},children:[e.jsx("button",{onClick:()=>c(Math.max(1,i-5)),style:D,children:"−"}),e.jsx("span",{style:{fontWeight:"700",color:"#111827",fontSize:"0.85rem",minWidth:24,textAlign:"center"},children:i}),e.jsx("button",{onClick:()=>c(i+5),style:D,children:"+"}),e.jsx("span",{style:{fontSize:"0.65rem",color:"#9CA3AF"},children:"días"})]}),e.jsx("div",{style:{height:1,backgroundColor:"#F3F4F6",margin:"10px 0"}}),e.jsx("p",{style:F,children:"Cliente"}),["name","company","email","phone"].map(o=>e.jsx("input",{value:m[o],onChange:s=>f({...m,[o]:s.target.value}),placeholder:{name:"Nombre",company:"Empresa",email:"Email",phone:"Teléfono"}[o],style:w},o)),e.jsx("div",{style:{height:1,backgroundColor:"#F3F4F6",margin:"10px 0"}}),e.jsx("p",{style:F,children:"Moneda"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:10},children:B.map(o=>e.jsxs("button",{onClick:()=>g(o.id),style:{padding:"3px 8px",borderRadius:5,border:`1.5px solid ${n===o.id?"#F59E0B":"#E5E7EB"}`,backgroundColor:n===o.id?"#FFFBEB":"#fff",color:n===o.id?"#92400E":"#374151",cursor:"pointer",fontSize:"0.63rem",fontWeight:"700"},children:[o.symbol," ",o.id]},o.id))}),e.jsx("p",{style:F,children:"IVA %"}),e.jsx("div",{style:{display:"flex",gap:4,marginBottom:10},children:[0,10,22].map(o=>e.jsxs("button",{onClick:()=>u(o),style:{flex:1,padding:"4px",borderRadius:5,border:`1.5px solid ${a===o?"#10B981":"#E5E7EB"}`,backgroundColor:a===o?"#D1FAE5":"#fff",color:a===o?"#10B981":"#374151",cursor:"pointer",fontSize:"0.68rem",fontWeight:"700"},children:[o,"%"]},o))}),e.jsx("p",{style:F,children:"Dto. global %"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[e.jsx("input",{type:"number",min:0,max:100,value:l,onChange:o=>r(Math.max(0,Math.min(100,Number(o.target.value)))),style:{...w,width:60,marginBottom:0,textAlign:"center",fontWeight:"700",color:"#F59E0B"}}),e.jsx("span",{style:{fontSize:"0.7rem",color:"#9CA3AF"},children:"% sobre subtotal"})]})]})}function I({items:p,setItems:n,quoteNumber:g,currency:a,iva:u,globalDiscount:l,client:r,validDays:x,status:h}){const i=B.find(t=>t.id===a),c=C[h],m=t=>t.qty*t.unitPrice*(1-t.discount/100),f=p.reduce((t,b)=>t+m(b),0),o=f*l/100,s=f-o,E=s*u/100,W=s+E,v=new Date;v.setDate(v.getDate()+x);const k=(t,b)=>n(d=>d.map(y=>y.id===t?{...y,...b}:y));return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{height:44,backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",alignItems:"center",padding:"0 16px",gap:10,flexShrink:0},children:[e.jsx(T,{size:14,color:"#F59E0B"}),e.jsxs("span",{style:{fontSize:"0.78rem",fontWeight:"700",color:"#374151"},children:["Presupuesto #",g]}),e.jsx("span",{style:{padding:"2px 7px",borderRadius:4,fontSize:"0.62rem",fontWeight:"700",backgroundColor:c.bg,color:c.color},children:c.label}),e.jsx("div",{style:{flex:1}}),e.jsxs("button",{onClick:()=>window.print(),style:{display:"flex",alignItems:"center",gap:5,padding:"6px 14px",borderRadius:7,border:"none",backgroundColor:"#F59E0B",color:"#fff",cursor:"pointer",fontSize:"0.74rem",fontWeight:"700"},children:[e.jsx(z,{size:12})," Exportar PDF"]})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"20px",backgroundColor:"#E5E7EB",display:"flex",justifyContent:"center"},children:e.jsxs("div",{style:{width:680,backgroundColor:"#fff",borderRadius:4,boxShadow:"0 4px 24px rgba(0,0,0,0.15)",padding:"48px 56px",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:5,backgroundColor:"#F59E0B",borderRadius:"4px 4px 0 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:28,paddingBottom:16,borderBottom:"2px solid #F3F4F6"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"900",color:"#FF6835"},children:"Charlie"}),e.jsx("div",{style:{fontSize:"0.7rem",color:"#9CA3AF"},children:"Marketplace Builder"})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"800",color:"#111827"},children:"PRESUPUESTO"}),e.jsxs("div",{style:{fontSize:"0.78rem",color:"#F59E0B",fontWeight:"700"},children:["#",g]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"#9CA3AF",marginTop:4},children:["Fecha: ",new Date().toLocaleDateString("es-UY"),e.jsx("br",{}),"Válido hasta: ",v.toLocaleDateString("es-UY")]})]})]}),(r.name||r.company||r.email)&&e.jsxs("div",{style:{marginBottom:20,padding:"12px 14px",backgroundColor:"#FFFBEB",borderRadius:8,border:"1px solid #FDE68A"},children:[e.jsx("div",{style:{fontSize:"0.62rem",fontWeight:"800",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.06em",marginBottom:4},children:"Cliente"}),r.name&&e.jsx("div",{style:{fontSize:"0.88rem",fontWeight:"700",color:"#111827"},children:r.name}),r.company&&e.jsx("div",{style:{fontSize:"0.78rem",color:"#374151"},children:r.company}),r.email&&e.jsx("div",{style:{fontSize:"0.72rem",color:"#6B7280"},children:r.email}),r.phone&&e.jsx("div",{style:{fontSize:"0.72rem",color:"#6B7280"},children:r.phone})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:16,fontSize:"0.82rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#F9FAFB"},children:[["Descripción","Cant.","Precio unit.","Dto. %","Subtotal"].map((t,b)=>e.jsx("th",{style:{padding:"8px 10px",textAlign:b===0?"left":"right",fontSize:"0.65rem",fontWeight:"800",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.04em",borderBottom:"2px solid #E5E7EB",whiteSpace:"nowrap"},children:t},t)),e.jsx("th",{style:{padding:"8px 4px",width:28,borderBottom:"2px solid #E5E7EB"}})]})}),e.jsx("tbody",{children:p.map((t,b)=>e.jsxs("tr",{style:{borderBottom:"1px solid #F3F4F6",backgroundColor:b%2===0?"#fff":"#FAFAFA"},children:[e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx("input",{value:t.description,placeholder:"Descripción del ítem...",onChange:d=>k(t.id,{description:d.target.value}),style:{border:"none",outline:"none",width:"100%",fontSize:"0.82rem",backgroundColor:"transparent",color:"#111827"}})}),["qty","unitPrice","discount"].map(d=>e.jsx("td",{style:{padding:"6px 10px",textAlign:"right"},children:e.jsx("input",{type:"number",min:0,value:t[d],onChange:y=>k(t.id,{[d]:Number(y.target.value)}),style:{border:"none",outline:"none",width:d==="discount"?40:70,textAlign:"right",fontSize:"0.82rem",backgroundColor:"transparent",color:"#374151",fontFamily:"monospace"}})},d)),e.jsx("td",{style:{padding:"6px 10px",textAlign:"right",fontWeight:"700",color:"#111827",fontFamily:"monospace",whiteSpace:"nowrap"},children:S(m(t),i.symbol)}),e.jsx("td",{style:{padding:"6px 4px",textAlign:"center"},children:e.jsx("button",{onClick:()=>n(d=>d.filter(y=>y.id!==t.id)),style:{border:"none",background:"none",color:"#E5E7EB",cursor:"pointer",fontSize:"0.8rem",padding:2,borderRadius:4},onMouseEnter:d=>{d.currentTarget.style.color="#EF4444"},onMouseLeave:d=>{d.currentTarget.style.color="#E5E7EB"},children:e.jsx(P,{size:11})})})]},t.id))})]}),e.jsxs("button",{onClick:()=>n(t=>[...t,A()]),style:{display:"flex",alignItems:"center",gap:5,padding:"6px 12px",borderRadius:6,border:"1.5px dashed #FDE68A",backgroundColor:"#FFFBEB",color:"#F59E0B",cursor:"pointer",fontSize:"0.74rem",fontWeight:"700",marginBottom:20},children:[e.jsx($,{size:12})," Agregar ítem"]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs("div",{style:{width:280},children:[[{label:"Subtotal bruto",value:f,color:"#374151"},...l>0?[{label:`Descuento global (${l}%)`,value:-o,color:"#EF4444"}]:[],{label:"Subtotal",value:s,color:"#374151"},...u>0?[{label:`IVA (${u}%)`,value:E,color:"#6B7280"}]:[]].map(t=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px 0",borderBottom:"1px solid #F3F4F6"},children:[e.jsx("span",{style:{fontSize:"0.78rem",color:"#6B7280"},children:t.label}),e.jsx("span",{style:{fontSize:"0.78rem",fontWeight:"600",color:t.color,fontFamily:"monospace"},children:S(t.value,i.symbol)})]},t.label)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0 4px",borderTop:"2px solid #111827",marginTop:2},children:[e.jsxs("span",{style:{fontSize:"0.9rem",fontWeight:"800",color:"#111827"},children:["TOTAL ",i.id]}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"900",color:"#F59E0B",fontFamily:"monospace"},children:S(W,i.symbol)})]})]})}),e.jsxs("div",{style:{position:"relative",marginTop:32,paddingTop:12,borderTop:"1px solid #F3F4F6",display:"flex",justifyContent:"space-between",fontSize:"0.62rem",color:"#D1D5DB"},children:[e.jsx("span",{children:"Generado con Charlie Marketplace Builder"}),e.jsxs("span",{children:["Válido por ",x," días desde la emisión"]})]})]})})]})}function M({items:p,currency:n,iva:g,globalDiscount:a,status:u}){const l=B.find(o=>o.id===n),r=C[u],x=o=>o.qty*o.unitPrice*(1-o.discount/100),h=p.reduce((o,s)=>o+x(s),0),i=h*a/100,c=h-i,m=c*g/100,f=c+m;return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:14,padding:"8px 10px",borderRadius:8,backgroundColor:r.bg,border:`1px solid ${r.color}30`,textAlign:"center"},children:e.jsx("span",{style:{fontSize:"0.72rem",fontWeight:"800",color:r.color},children:r.label})}),e.jsx("p",{style:L,children:"Resumen financiero"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,marginBottom:14},children:[{l:"Ítems",v:`${p.length}`,mono:!1},{l:"Subtotal",v:S(c,l.symbol),mono:!0},{l:`IVA ${g}%`,v:S(m,l.symbol),mono:!0},{l:`Dto. ${a}%`,v:S(-i,l.symbol),mono:!0}].map(o=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 8px",backgroundColor:"#F9FAFB",borderRadius:5},children:[e.jsx("span",{style:{fontSize:"0.7rem",color:"#6B7280"},children:o.l}),e.jsx("span",{style:{fontSize:"0.7rem",fontWeight:"700",color:"#374151",fontFamily:o.mono?"monospace":"inherit"},children:o.v})]},o.l))}),e.jsxs("div",{style:{padding:"14px",backgroundColor:"#FFFBEB",border:"2px solid #F59E0B",borderRadius:10,textAlign:"center",marginBottom:14},children:[e.jsxs("div",{style:{fontSize:"0.62rem",fontWeight:"800",color:"#92400E",textTransform:"uppercase",letterSpacing:"0.06em",marginBottom:4},children:["TOTAL ",n]}),e.jsx("div",{style:{fontSize:"1.4rem",fontWeight:"900",color:"#F59E0B",fontFamily:"monospace"},children:S(f,l.symbol)})]}),e.jsxs("button",{onClick:()=>window.print(),style:{width:"100%",padding:"9px",borderRadius:8,border:"none",backgroundColor:"#F59E0B",color:"#fff",cursor:"pointer",fontSize:"0.78rem",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[e.jsx(z,{size:13})," Exportar PDF"]})]})}const F={fontSize:"0.6rem",fontWeight:"800",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.08em",margin:"0 0 5px"},L={fontSize:"0.62rem",fontWeight:"700",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.05em",margin:"0 0 4px"},w={width:"100%",padding:"6px 8px",border:"1px solid #E5E7EB",borderRadius:6,fontSize:"0.76rem",outline:"none",marginBottom:6,boxSizing:"border-box",color:"#374151",backgroundColor:"#fff"},D={width:24,height:24,borderRadius:5,border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"0.9rem",color:"#374151",display:"flex",alignItems:"center",justifyContent:"center"};function H({onNavigate:p}){const[n,g]=j.useState("UYU"),[a,u]=j.useState(22),[l,r]=j.useState(0),[x,h]=j.useState(30),[i,c]=j.useState("draft"),[m,f]=j.useState({name:"",company:"",email:"",phone:""}),[o,s]=j.useState([{...A(),description:"Servicio de consultoría",qty:1,unitPrice:5e3},{...A(),description:"Licencia anual software",qty:1,unitPrice:12e3}]),E=`PRE-${new Date().getFullYear()}-${String(Math.floor(Math.random()*9e3)+1e3)}`;return e.jsx(R,{toolId:"gen-presupuestos",onNavigate:p,leftPanel:e.jsx(U,{quoteNumber:E,currency:n,setCurrency:g,iva:a,setIva:u,globalDiscount:l,setGlobalDiscount:r,status:i,setStatus:c,validDays:x,setValidDays:h,client:m,setClient:f}),canvas:e.jsx(I,{items:o,setItems:s,quoteNumber:E,currency:n,iva:a,globalDiscount:l,client:m,validDays:x,status:i}),properties:e.jsx(M,{items:o,currency:n,iva:a,globalDiscount:l,status:i}),actions:e.jsxs("button",{onClick:()=>window.print(),style:{display:"flex",alignItems:"center",gap:4,padding:"4px 10px",borderRadius:5,border:"none",backgroundColor:"#F59E0B",color:"#fff",cursor:"pointer",fontSize:"0.72rem",fontWeight:"700"},children:[e.jsx(z,{size:12})," PDF"]})})}export{H as GenPresupuestosWorkspace};
