import{c as k,s as S,r as d,j as e,P as E,R as P,A as L,f as T}from"./index-DpZjhHPo.js";import{O}from"./OrangeHeader-DclloVy3.js";import{L as $}from"./layers-D_kJuqb4.js";import{C as q}from"./circle-check-Bf3OLNcx.js";import{B as N}from"./box-C5AlDmwC.js";import{C as Y}from"./clock-D59q7OwI.js";import{C as v}from"./check-CRM0evzL.js";import{P as Z}from"./play-DNmY4L2t.js";import{P as G}from"./plus-CCTKK9H9.js";import"./zap-DLTL4QpT.js";import"./lightbulb-Eph2A-kA.js";import"./map-pin-CDgTiIOI.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],U=k("archive",M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],H=k("pause",V);async function K(g){let a=S.from("fulfillment_ordenes").select("*");const{data:f,error:n}=await a.order("created_at",{ascending:!1});if(n)throw console.error("[fulfillmentApi] Error obteniendo Ã³rdenes de fulfillment:",n),new Error(n.message||"Error cargando Ã³rdenes de fulfillment");return f||[]}async function X(g){let a=S.from("fulfillment_waves").select("*");const{data:f,error:n}=await a.order("created_at",{ascending:!1});if(n)throw console.error("[fulfillmentApi] Error obteniendo waves:",n),new Error(n.message||"Error cargando waves");return f||[]}const l="#FF6835";function xe({onNavigate:g}){var C;const[a,f]=d.useState("ordenes"),[n,z]=d.useState(""),[h,A]=d.useState("todos"),[i,b]=d.useState(null),[B,R]=d.useState([]),[W,w]=d.useState([]),[J,y]=d.useState(!1),[Q,j]=d.useState(null);d.useEffect(()=>{_()},[]);const _=async()=>{y(!0),j(null);try{const[o,r]=await Promise.all([K(),X()]),s=o.map(t=>({id:t.id,numero:t.numero||"",pedido:t.pedido||"",cliente:t.cliente,estado:t.estado,prioridad:t.prioridad||"normal",items:t.items||0,zona:t.zona||"",tiempoEstimado:t.tiempo_estimado||"â€”",fechaCreacion:t.fecha_creacion||t.created_at||"",wave:t.wave_id,operario:t.operario,lineas:Array.isArray(t.lineas)?t.lineas:[]})),x=r.map(t=>({id:t.id,nombre:t.nombre,ordenes:Array.isArray(t.ordenes)?t.ordenes.length:0,items:0,estado:t.estado,operarios:t.operarios||0,inicio:t.inicio}));R(s),w(x),s.length>0&&b(s[0])}catch(o){j(o instanceof Error?o.message:"Error cargando datos"),console.error("Error cargando fulfillment:",o)}finally{y(!1)}},p=B,F=W,c={pendiente:{label:"Pendiente",color:"#6B7280",bg:"#F3F4F6",icon:Y},en_picking:{label:"En Picking",color:"#2563EB",bg:"#EFF6FF",icon:E},listo_empacar:{label:"Listo Empacar",color:l,bg:"#FFF4EC",icon:N},empacado:{label:"Empacado",color:"#7C3AED",bg:"#F5F3FF",icon:U},despachado:{label:"Despachado",color:"#059669",bg:"#ECFDF5",icon:q}},m={urgente:{label:"ðŸ”´ Urgente",color:"#DC2626"},alta:{label:"ðŸŸ  Alta",color:l},normal:{label:"ðŸŸ¡ Normal",color:"#D97706"},baja:{label:"âšª Baja",color:"#6B7280"}},I=p.filter(o=>!(h!=="todos"&&o.estado!==h||n&&!o.numero.toLowerCase().includes(n.toLowerCase())&&!o.cliente.toLowerCase().includes(n.toLowerCase()))),u={pendientes:p.filter(o=>o.estado==="pendiente").length,en_picking:p.filter(o=>o.estado==="en_picking").length,listo_empacar:p.filter(o=>o.estado==="listo_empacar").length,empacado:p.filter(o=>o.estado==="empacado").length,despachado:p.filter(o=>o.estado==="despachado").length};return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx(O,{icon:$,title:"Fulfillment / Picking",subtitle:`${u.pendientes} pendientes Â· ${u.en_picking} en picking Â· ${u.listo_empacar} listos para empacar`,actions:[{label:"â† LogÃ­stica",onClick:()=>g("logistica")},{label:"âš¡ Crear Wave",primary:!0}]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",backgroundColor:"#F8F9FA"},children:[e.jsx("div",{style:{display:"flex",gap:"0",padding:"16px 20px 0",overflowX:"auto"},children:Object.entries(c).map(([o,r],s)=>{const x=p.filter(D=>D.estado===o).length,t=r.icon;return e.jsxs(P.Fragment,{children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"12px 16px",backgroundColor:"#fff",borderRadius:s===0?"12px 0 0 12px":s===4?"0 12px 12px 0":"0",border:"1px solid #E5E7EB",borderLeft:s>0?"0":"1px solid #E5E7EB",minWidth:"120px",flex:1},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"10px",backgroundColor:r.bg,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"6px"},children:e.jsx(t,{size:16,color:r.color})}),e.jsx("div",{style:{fontSize:"22px",fontWeight:800,color:r.color},children:x}),e.jsx("div",{style:{fontSize:"10px",color:"#9CA3AF",textAlign:"center",marginTop:"2px"},children:r.label})]}),s<4&&e.jsx("div",{style:{display:"flex",alignItems:"center",zIndex:1},children:e.jsx(L,{size:14,color:"#D1D5DB"})})]},o)})}),e.jsx("div",{style:{display:"flex",padding:"12px 20px 0",gap:"0",backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",marginTop:"12px"},children:[["ordenes","ðŸ“‹ Ã“rdenes"],["waves","âš¡ Waves"],["empaque","ðŸ“¦ Empaque"]].map(([o,r])=>e.jsx("button",{onClick:()=>f(o),style:{padding:"10px 20px",border:"none",backgroundColor:"transparent",cursor:"pointer",fontSize:"13px",fontWeight:a===o?700:500,color:a===o?l:"#6B7280",borderBottom:a===o?`2px solid ${l}`:"2px solid transparent"},children:r},o))}),e.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[a==="ordenes"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{width:"400px",flexShrink:0,display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRight:"1px solid #E5E7EB"},children:[e.jsxs("div",{style:{padding:"12px 14px",borderBottom:"1px solid #E5E7EB",display:"flex",gap:"8px"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(T,{size:13,color:"#9CA3AF",style:{position:"absolute",left:"9px",top:"50%",transform:"translateY(-50%)"}}),e.jsx("input",{value:n,onChange:o=>z(o.target.value),placeholder:"Buscar orden...",style:{width:"100%",paddingLeft:"28px",paddingRight:"8px",paddingTop:"7px",paddingBottom:"7px",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("select",{value:h,onChange:o=>A(o.target.value),style:{padding:"7px 10px",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px",backgroundColor:"#fff"},children:[e.jsx("option",{value:"todos",children:"Todos"}),Object.entries(c).map(([o,r])=>e.jsx("option",{value:o,children:r.label},o))]})]}),e.jsx("div",{style:{flex:1,overflowY:"auto"},children:I.map(o=>{const r=c[o.estado],s=m[o.prioridad],x=r.icon,t=(i==null?void 0:i.id)===o.id;return e.jsxs("div",{onClick:()=>b(o),style:{padding:"12px 14px",borderBottom:"1px solid #F3F4F6",cursor:"pointer",backgroundColor:t?"#FFF4EC":"transparent",borderLeft:t?`3px solid ${l}`:"3px solid transparent"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",backgroundColor:r.bg,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(x,{size:13,color:r.color})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:"12px",fontWeight:700,color:"#111"},children:o.numero}),e.jsxs("div",{style:{fontSize:"11px",color:"#9CA3AF"},children:[o.cliente," Â· Zona ",o.zona]})]}),e.jsx("span",{style:{fontSize:"10px",color:s.color,fontWeight:700,flexShrink:0},children:s.label})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:r.color,backgroundColor:r.bg,padding:"2px 8px",borderRadius:"8px"},children:r.label}),e.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"10px",color:"#9CA3AF"},children:[e.jsxs("span",{children:["ðŸ“¦ ",o.items," items"]}),o.operario&&e.jsxs("span",{children:["ðŸ‘¤ ",o.operario]}),o.tiempoEstimado!=="â€”"&&e.jsxs("span",{children:["â± ",o.tiempoEstimado]})]})]})]},o.id)})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"20px 24px"},children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:800,color:"#111"},children:i.numero}),e.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:c[i.estado].color,backgroundColor:c[i.estado].bg,padding:"3px 10px",borderRadius:"10px"},children:c[i.estado].label}),e.jsx("span",{style:{fontSize:"11px",color:m[i.prioridad].color,fontWeight:700},children:m[i.prioridad].label}),e.jsx("div",{style:{flex:1}}),i.estado==="pendiente"&&e.jsx("button",{style:{padding:"8px 16px",border:"none",borderRadius:"8px",backgroundColor:"#2563EB",color:"#fff",fontSize:"12px",fontWeight:700,cursor:"pointer"},children:"â–¶ Iniciar Picking"}),i.estado==="listo_empacar"&&e.jsx("button",{style:{padding:"8px 16px",border:"none",borderRadius:"8px",backgroundColor:l,color:"#fff",fontSize:"12px",fontWeight:700,cursor:"pointer"},children:"ðŸ“¦ Empacar"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"20px"},children:[["Pedido",i.pedido],["Cliente",i.cliente],["Zona depÃ³sito",`Zona ${i.zona}`],["Wave",i.wave&&((C=F.find(o=>o.id===i.wave))==null?void 0:C.nombre)||"â€”"],["Operario",i.operario||"Sin asignar"],["T. estimado",i.tiempoEstimado]].map(([o,r])=>e.jsxs("div",{style:{backgroundColor:"#F9FAFB",borderRadius:"8px",padding:"10px 12px"},children:[e.jsx("div",{style:{fontSize:"10px",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"4px"},children:o}),e.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#111"},children:r})]},o))}),i.lineas.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:{margin:"0 0 12px",fontSize:"13px",fontWeight:800,color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"LÃ­neas de Picking"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:i.lineas.map((o,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",borderRadius:"10px",border:`1px solid ${o.pickeado?"#A7F3D0":"#E5E7EB"}`,backgroundColor:o.pickeado?"#F0FDF4":"#fff"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",backgroundColor:o.pickeado?"#D1FAE5":"#F3F4F6",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:o.pickeado?e.jsx(v,{size:14,color:"#059669"}):e.jsx(E,{size:14,color:"#9CA3AF"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#111"},children:o.descripcion}),e.jsxs("div",{style:{fontSize:"11px",color:"#9CA3AF",marginTop:"2px"},children:["SKU: ",o.sku," Â· UbicaciÃ³n: ",e.jsx("strong",{style:{color:"#2563EB"},children:o.ubicacion})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("span",{style:{fontSize:"14px",fontWeight:800,color:"#111"},children:["Ã—",o.cantidad]}),e.jsx("button",{style:{width:"28px",height:"28px",borderRadius:"8px",border:`1.5px solid ${o.pickeado?"#059669":"#E5E7EB"}`,backgroundColor:o.pickeado?"#059669":"#fff",color:o.pickeado?"#fff":"#9CA3AF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.jsx(v,{size:13})})]})]},r))})]})]}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#9CA3AF"},children:"SeleccionÃ¡ una orden para ver el detalle"})})]}),a==="waves"&&e.jsx("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(280px,1fr))",gap:"14px"},children:[F.map(o=>{const r={abierta:{color:"#2563EB",bg:"#EFF6FF",label:"Abierta"},en_proceso:{color:l,bg:"#FFF4EC",label:"En proceso"},completada:{color:"#059669",bg:"#ECFDF5",label:"Completada"}}[o.estado];return e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:`1px solid ${o.estado==="en_proceso"?l:"#E5E7EB"}`,padding:"20px",boxShadow:o.estado==="en_proceso"?`0 0 0 3px ${l}22`:"none"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"14px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:800,color:"#111",marginBottom:"4px"},children:o.nombre}),e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:r.color,backgroundColor:r.bg,padding:"2px 8px",borderRadius:"10px"},children:r.label})]}),o.inicio&&e.jsxs("span",{style:{fontSize:"11px",color:"#9CA3AF"},children:["â° ",o.inicio]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"14px"},children:[["Ã“rdenes",o.ordenes,"ðŸ“‹"],["Items",o.items,"ðŸ“¦"],["Operarios",o.operarios||"â€”","ðŸ‘¤"]].map(([s,x,t])=>e.jsxs("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F9FAFB",borderRadius:"8px"},children:[e.jsxs("div",{style:{fontSize:"18px",fontWeight:800,color:"#111"},children:[t," ",x]}),e.jsx("div",{style:{fontSize:"10px",color:"#9CA3AF"},children:s})]},s))}),o.estado!=="completada"&&e.jsx("button",{style:{width:"100%",padding:"10px",border:"none",borderRadius:"8px",backgroundColor:o.estado==="abierta"?l:"#F3F4F6",color:o.estado==="abierta"?"#fff":"#6B7280",fontSize:"13px",fontWeight:700,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:o.estado==="abierta"?e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:13})," Iniciar Wave"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{size:13})," Pausar"]})})]},o.id)}),e.jsxs("div",{style:{backgroundColor:"#FAFAFA",borderRadius:"12px",border:"2px dashed #E5E7EB",padding:"24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",minHeight:"180px"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"50%",backgroundColor:"#FFF4EC",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(G,{size:22,color:l})}),e.jsx("span",{style:{fontSize:"13px",fontWeight:700,color:l},children:"Nueva Wave"})]})]})}),a==="empaque"&&e.jsx("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:e.jsxs("div",{style:{maxWidth:"700px"},children:[e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{margin:"0 0 14px",fontSize:"14px",fontWeight:800,color:"#111"},children:"Cola de Empaque"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:p.filter(o=>["listo_empacar","empacado"].includes(o.estado)).map(o=>{const r=c[o.estado],s=r.icon;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 14px",border:"1px solid #E5E7EB",borderRadius:"10px",backgroundColor:o.estado==="listo_empacar"?"#FFFBEB":"#F0FDF4"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"10px",backgroundColor:r.bg,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(s,{size:16,color:r.color})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"13px",fontWeight:700,color:"#111"},children:[o.numero," â€” ",o.cliente]}),e.jsxs("div",{style:{fontSize:"11px",color:"#9CA3AF"},children:[o.items," items Â· Zona ",o.zona]})]}),e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:r.color,backgroundColor:r.bg,padding:"3px 10px",borderRadius:"10px"},children:r.label}),o.estado==="listo_empacar"&&e.jsx("button",{style:{padding:"8px 14px",border:"none",borderRadius:"8px",backgroundColor:l,color:"#fff",fontSize:"12px",fontWeight:700,cursor:"pointer"},children:"ðŸ“¦ Empacar"})]},o.id)})})]}),e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 14px",fontSize:"14px",fontWeight:800,color:"#111"},children:"Materiales de Empaque"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[{nombre:"Caja 30Ã—20Ã—15 cm",stock:124,alerta:!1},{nombre:"Caja 40Ã—30Ã—20 cm",stock:78,alerta:!1},{nombre:"Sobre burbuja A4",stock:23,alerta:!0},{nombre:"Cinta de embalar",stock:8,alerta:!0},{nombre:"Film stretch",stock:5,alerta:!0},{nombre:"Relleno biodegradable",stock:340,alerta:!1}].map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 14px",border:`1px solid ${o.alerta?"#FCA5A5":"#E5E7EB"}`,borderRadius:"8px",backgroundColor:o.alerta?"#FFF5F5":"#fff"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:o.alerta?"#EF4444":"#059669",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"12px",fontWeight:600,color:"#111"},children:o.nombre}),e.jsxs("div",{style:{fontSize:"11px",color:o.alerta?"#DC2626":"#9CA3AF"},children:["Stock: ",o.stock," u. ",o.alerta?"âš  Bajo":""]})]})]},o.nombre))})]})]})})]})]})]})}export{xe as FulfillmentView};
