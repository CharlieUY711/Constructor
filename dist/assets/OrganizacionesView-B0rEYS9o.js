import{r as t,t as l,j as e,f as $}from"./index-CIyRulNs.js";import{O as q}from"./OrangeHeader-DALVz63p.js";import{g as V,d as X,u as J,c as K}from"./organizacionesApi-AcEkTrDr.js";import{B as v}from"./building-2-C6HDFzPp.js";import{R as F}from"./refresh-cw-r7NzjUbd.js";import{M as Q}from"./mail-_O088xfC.js";import{P as Z}from"./phone-CyoehitK.js";import{G as ee}from"./globe-BlUz5sm2.js";import{M as ie}from"./map-pin-Yju8XAbq.js";import{P as re}from"./pen-DbIOOgs5.js";import{T as oe}from"./trash-2-r76tZ4bg.js";import{X as te}from"./x-BNB3OjT8.js";import{S as ae}from"./save-DyQ2nyYr.js";import"./ConnectionStatusIcon-CJlRDQn6.js";import"./zap-ZahoFP5c.js";import"./lightbulb-CCL6DIoL.js";const I="#FF6835",R=["","empresa","cooperativa","fundacion","gobierno","otro"],ne=["","Tecnolog铆a","Retail","Agro","Construcci贸n","Salud","Educaci贸n","Finanzas","Log铆stica","Manufactura","Servicios","Otro"],T={nombre:"",tipo:"",industria:"",email:"",telefono:"",sitio_web:"",direccion:{calle:"",ciudad:"",pais:""},activo:!0};function Ce({onNavigate:se}){var S,w,B,k;const[b,A]=t.useState([]),[W,j]=t.useState(!0),[f,N]=t.useState(""),[m,D]=t.useState(""),[u,M]=t.useState(""),[_,d]=t.useState(!1),[c,E]=t.useState(null),[o,a]=t.useState({...T}),[x,z]=t.useState(!1),[P,C]=t.useState(null),p=t.useCallback(async()=>{j(!0);try{const i=await V({search:f||void 0,tipo:m||void 0,activo:u!==""?u==="true":void 0});A(i)}catch(i){console.error("Error cargando organizaciones:",i),l.error("Error al cargar organizaciones")}finally{j(!1)}},[f,m,u]);t.useEffect(()=>{p()},[p]);const G=()=>{E(null),a({...T}),d(!0)},L=i=>{E(i),a({nombre:i.nombre,tipo:i.tipo??"",industria:i.industria??"",email:i.email??"",telefono:i.telefono??"",sitio_web:i.sitio_web??"",direccion:i.direccion??{calle:"",ciudad:"",pais:""},activo:i.activo}),d(!0)},U=async()=>{if(!o.nombre.trim()){l.error("El nombre es requerido");return}z(!0);try{const i={...o};if(c){if(!await J(c.id,i))throw new Error("No se pudo actualizar la organizaci贸n")}else if(!await K(i))throw new Error("No se pudo crear la organizaci贸n");l.success(c?"Organizaci贸n actualizada":"Organizaci贸n creada"),d(!1),p()}catch(i){console.error("Error guardando organizaci贸n:",i),l.error(`Error al guardar: ${i instanceof Error?i.message:i}`)}finally{z(!1)}},H=async i=>{if(confirm("驴Eliminar esta organizaci贸n? Esta acci贸n no se puede deshacer.")){C(i);try{if(!await X(i))throw new Error("No se pudo eliminar la organizaci贸n");l.success("Organizaci贸n eliminada"),p()}catch(r){console.error("Error eliminando organizaci贸n:",r),l.error("Error al eliminar")}finally{C(null)}}},h=(i,r)=>a(g=>({...g,direccion:{...g.direccion??{},[i]:r}})),Y={empresa:"#3B82F6",cooperativa:"#10B981",fundacion:"#8B5CF6",gobierno:"#F59E0B",otro:"#6B7280"};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[e.jsx(q,{icon:v,title:"Organizaciones",subtitle:"Empresas, cooperativas y entidades del sistema",actions:[{label:"+ Nueva Organizaci贸n",primary:!0,onClick:G}]}),e.jsxs("div",{style:{padding:"16px 28px",backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",gap:"12px",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px"},children:[e.jsx($,{size:15,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9CA3AF"}}),e.jsx("input",{value:f,onChange:i=>N(i.target.value),placeholder:"Buscar por nombre o email...",style:{width:"100%",paddingLeft:32,paddingRight:12,height:36,border:"1.5px solid #E5E7EB",borderRadius:8,fontSize:"0.875rem",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("select",{value:m,onChange:i=>D(i.target.value),style:{height:36,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.875rem",color:"#374151",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"Todos los tipos"}),R.filter(Boolean).map(i=>e.jsx("option",{value:i,children:i.charAt(0).toUpperCase()+i.slice(1)},i))]}),e.jsxs("select",{value:u,onChange:i=>M(i.target.value),style:{height:36,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.875rem",color:"#374151",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"true",children:"Activas"}),e.jsx("option",{value:"false",children:"Inactivas"})]}),e.jsx("button",{onClick:p,style:{height:36,width:36,border:"1.5px solid #E5E7EB",borderRadius:8,background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(F,{size:15,color:"#6B7280"})})]}),e.jsx("div",{style:{flex:1,overflow:"auto",padding:"20px 28px"},children:W?e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:200,color:"#9CA3AF"},children:[e.jsx(F,{size:20,style:{animation:"spin 1s linear infinite",marginRight:8}})," Cargando organizaciones..."]}):b.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#9CA3AF"},children:[e.jsx(v,{size:48,style:{marginBottom:12,opacity:.3}}),e.jsx("p",{style:{fontSize:"1rem",fontWeight:600},children:"No hay organizaciones registradas"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:4},children:'Cre谩 la primera usando el bot贸n "+ Nueva Organizaci贸n"'})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},children:b.map(i=>{var g;const r=Y[i.tipo??""]??"#6B7280";return e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:12,border:"1px solid #E5E7EB",overflow:"hidden",transition:"box-shadow 0.2s"},onMouseEnter:y=>y.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.08)",onMouseLeave:y=>y.currentTarget.style.boxShadow="",children:[e.jsx("div",{style:{height:4,backgroundColor:r}}),e.jsxs("div",{style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:10,backgroundColor:r+"18",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(v,{size:20,color:r})}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontWeight:700,color:"#111827",fontSize:"0.9rem"},children:i.nombre}),i.tipo&&e.jsx("span",{style:{fontSize:"0.72rem",fontWeight:600,color:r,backgroundColor:r+"15",padding:"2px 7px",borderRadius:20},children:i.tipo.charAt(0).toUpperCase()+i.tipo.slice(1)})]})]}),e.jsx("span",{style:{fontSize:"0.72rem",fontWeight:600,color:i.activo?"#10B981":"#EF4444",backgroundColor:i.activo?"#D1FAE5":"#FEE2E2",padding:"2px 8px",borderRadius:20},children:i.activo?"Activa":"Inactiva"})]}),i.industria&&e.jsxs("p",{style:{margin:"0 0 10px",fontSize:"0.8rem",color:"#6B7280"},children:[" ",i.industria]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,marginBottom:12},children:[i.email&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:"0.8rem",color:"#6B7280"},children:[e.jsx(Q,{size:13}),i.email]}),i.telefono&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:"0.8rem",color:"#6B7280"},children:[e.jsx(Z,{size:13}),i.telefono]}),i.sitio_web&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:"0.8rem",color:"#3B82F6"},children:[e.jsx(ee,{size:13}),e.jsx("a",{href:i.sitio_web,target:"_blank",rel:"noopener noreferrer",style:{color:"#3B82F6",textDecoration:"none"},children:i.sitio_web})]}),((g=i.direccion)==null?void 0:g.ciudad)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:"0.8rem",color:"#6B7280"},children:[e.jsx(ie,{size:13}),i.direccion.ciudad,i.direccion.pais?`, ${i.direccion.pais}`:""]})]}),e.jsxs("div",{style:{display:"flex",gap:8,borderTop:"1px solid #F3F4F6",paddingTop:12},children:[e.jsxs("button",{onClick:()=>L(i),style:{flex:1,padding:"7px",borderRadius:7,border:"1.5px solid #E5E7EB",background:"#fff",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,color:"#374151",display:"flex",alignItems:"center",justifyContent:"center",gap:5},children:[e.jsx(re,{size:13})," Editar"]}),e.jsx("button",{onClick:()=>H(i.id),disabled:P===i.id,style:{padding:"7px 12px",borderRadius:7,border:"1.5px solid #FEE2E2",background:"#FFF5F5",cursor:"pointer",display:"flex",alignItems:"center",gap:4,fontSize:"0.8rem",color:"#EF4444"},children:e.jsx(oe,{size:13})})]})]})]},i.id)})})}),_&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:20},children:e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:16,width:"100%",maxWidth:580,maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:700,color:"#111827"},children:c?"Editar Organizaci贸n":"Nueva Organizaci贸n"}),e.jsx("button",{onClick:()=>d(!1),style:{background:"none",border:"none",cursor:"pointer",color:"#9CA3AF"},children:e.jsx(te,{size:20})})]}),e.jsxs("div",{style:{padding:"20px 24px",display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{children:[e.jsx("label",{style:s,children:"Nombre / Raz贸n Social *"}),e.jsx("input",{value:o.nombre,onChange:i=>a(r=>({...r,nombre:i.target.value})),style:n,placeholder:"Ej: TechSur SA"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:s,children:"Tipo de Organizaci贸n"}),e.jsxs("select",{value:o.tipo??"",onChange:i=>a(r=>({...r,tipo:i.target.value})),style:O,children:[e.jsx("option",{value:"",children:"Sin especificar"}),R.filter(Boolean).map(i=>e.jsx("option",{value:i,children:i.charAt(0).toUpperCase()+i.slice(1)},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:s,children:"Industria"}),e.jsxs("select",{value:o.industria??"",onChange:i=>a(r=>({...r,industria:i.target.value})),style:O,children:[e.jsx("option",{value:"",children:"Sin especificar"}),ne.filter(Boolean).map(i=>e.jsx("option",{value:i,children:i},i))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:s,children:"Email"}),e.jsx("input",{type:"email",value:o.email??"",onChange:i=>a(r=>({...r,email:i.target.value})),style:n,placeholder:"contacto@empresa.com"})]}),e.jsxs("div",{children:[e.jsx("label",{style:s,children:"Tel茅fono"}),e.jsx("input",{value:o.telefono??"",onChange:i=>a(r=>({...r,telefono:i.target.value})),style:n,placeholder:"+598 2 123 4567"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:s,children:"Sitio Web"}),e.jsx("input",{value:o.sitio_web??"",onChange:i=>a(r=>({...r,sitio_web:i.target.value})),style:n,placeholder:"https://www.empresa.com"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{...s,marginBottom:8,display:"block"},children:"Direcci贸n"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[e.jsx("input",{value:((S=o.direccion)==null?void 0:S.calle)??"",onChange:i=>h("calle",i.target.value),style:n,placeholder:"Calle y n煤mero"}),e.jsx("input",{value:((w=o.direccion)==null?void 0:w.ciudad)??"",onChange:i=>h("ciudad",i.target.value),style:n,placeholder:"Ciudad"}),e.jsx("input",{value:((B=o.direccion)==null?void 0:B.pais)??"",onChange:i=>h("pais",i.target.value),style:n,placeholder:"Pa铆s"}),e.jsx("input",{value:((k=o.direccion)==null?void 0:k.cp)??"",onChange:i=>h("cp",i.target.value),style:n,placeholder:"C贸digo postal"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("input",{type:"checkbox",id:"org-activo",checked:o.activo,onChange:i=>a(r=>({...r,activo:i.target.checked})),style:{width:16,height:16,cursor:"pointer",accentColor:I}}),e.jsx("label",{htmlFor:"org-activo",style:{fontSize:"0.875rem",color:"#374151",cursor:"pointer"},children:"Organizaci贸n activa en el sistema"})]})]}),e.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #E5E7EB",display:"flex",justifyContent:"flex-end",gap:10},children:[e.jsx("button",{onClick:()=>d(!1),style:{padding:"9px 20px",borderRadius:8,border:"1.5px solid #E5E7EB",background:"#fff",cursor:"pointer",fontSize:"0.875rem",fontWeight:600,color:"#374151"},children:"Cancelar"}),e.jsxs("button",{onClick:U,disabled:x,style:{padding:"9px 24px",borderRadius:8,border:"none",backgroundColor:I,color:"#fff",cursor:x?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:700,display:"flex",alignItems:"center",gap:6,opacity:x?.7:1},children:[e.jsx(ae,{size:15})," ",x?"Guardando...":c?"Guardar cambios":"Crear organizaci贸n"]})]})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}const s={display:"block",fontSize:"0.8rem",fontWeight:600,color:"#374151",marginBottom:5},n={width:"100%",height:38,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 12px",fontSize:"0.875rem",color:"#111827",outline:"none",boxSizing:"border-box"},O={width:"100%",height:38,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.875rem",color:"#374151",cursor:"pointer",outline:"none"};export{Ce as OrganizacionesView};
