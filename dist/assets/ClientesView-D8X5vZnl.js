import{r as n,t as b,j as e,g as G,f as H}from"./index-C7B7W1lQ.js";import{O as X}from"./OrangeHeader-CoTBbwWn.js";import{g as k}from"./personasApi-DO87xSjh.js";import{g as Y}from"./organizacionesApi-BrL9UqnA.js";import{S as J}from"./shopping-bag-CAZmviAm.js";import{T as V}from"./tag-BcdFaf5K.js";import{U as u}from"./user-BzTSdjQp.js";import{B as j}from"./building-2-2HrySnZ4.js";import{C as q}from"./circle-x-Cl1JMT7N.js";import{R as B}from"./refresh-cw-Cc9OU0Xn.js";import{P as K}from"./phone-CYvCauyC.js";import{C as Q}from"./calendar-zaGvsGVR.js";import{X as Z}from"./x-Bh1hE7_D.js";import{S as ee}from"./save--oZ-Y1nT.js";import"./zap-DaP38y9l.js";import"./lightbulb-QoB3Dxu8.js";import"./map-pin-QypTHBjh.js";const i="#FF6835";function be({onNavigate:c}){const[t,f]=n.useState([]),[R,C]=n.useState(!0),[s,W]=n.useState("personas"),[p,E]=n.useState(""),[x,D]=n.useState(!0),[I,l]=n.useState(!1),[z,P]=n.useState([]),[S,_]=n.useState([]),[g,a]=n.useState({persona_id:"",organizacion_id:"",contexto:"",activo:!0}),[h,T]=n.useState(!1),m=n.useCallback(async()=>{C(!0);try{const o=await k({rol:"cliente",activo:x});f(o)}catch(o){console.error("Error cargando clientes:",o),b.error("Error al cargar clientes")}finally{C(!1)}},[x]),O=n.useCallback(async()=>{try{const[o,r]=await Promise.all([k({activo:!0}),Y({activo:!0})]);P(o),_(r)}catch(o){console.error("Error cargando opciones:",o)}},[]);n.useEffect(()=>{m()},[m]);const y=n.useMemo(()=>t.filter(o=>{if(!p)return!0;const r=`${o.nombre??""} ${o.apellido??""}`.toLowerCase(),d=(o.email??"").toLowerCase(),F=p.toLowerCase();return r.includes(F)||d.includes(F)}),[t,p]);n.useMemo(()=>[],[]);const L=t.filter(o=>o.activo).length,M=t.filter(o=>!o.activo).length,N=()=>{O(),a({persona_id:"",organizacion_id:"",contexto:"",activo:!0}),l(!0)},$=async()=>{b.error("Funcionalidad pendiente - endpoint /api/personas con rol cliente"),T(!1)},U=async o=>{b.error("Funcionalidad pendiente - actualizaciÃ³n de rol cliente")};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[e.jsx(X,{icon:J,title:"Clientes",subtitle:"Personas y organizaciones con rol de cliente en el sistema",actions:[{label:"+ Registrar Cliente",primary:!0,onClick:N}]}),e.jsx("div",{style:{padding:"14px 28px",backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",gap:12,flexWrap:"wrap"},children:[{label:"Total Clientes",value:t.length,icon:V,color:i},{label:"Personas Clientes",value:t.length,icon:u,color:"#3B82F6"},{label:"Orgs. Clientes",value:0,icon:j,color:"#8B5CF6"},{label:"Activos",value:L,icon:G,color:"#10B981"},{label:"Inactivos",value:M,icon:q,color:"#EF4444"}].map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 14px",backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB"},children:[e.jsx("div",{style:{width:34,height:34,borderRadius:8,backgroundColor:o.color+"18",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(o.icon,{size:16,color:o.color})}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontSize:"1.15rem",fontWeight:800,color:"#111827",lineHeight:1},children:o.value}),e.jsx("p",{style:{margin:0,fontSize:"0.7rem",color:"#6B7280"},children:o.label})]})]},o.label))}),e.jsx("div",{style:{backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",padding:"0 28px",display:"flex",gap:0},children:[{key:"personas",label:"Personas Clientes",icon:u,count:t.length},{key:"organizaciones",label:"Organizaciones Clientes",icon:j,count:0}].map(o=>e.jsxs("button",{onClick:()=>{W(o.key),E("")},style:{display:"flex",alignItems:"center",gap:7,padding:"12px 18px",border:"none",background:"none",cursor:"pointer",borderBottom:s===o.key?`3px solid ${i}`:"3px solid transparent",color:s===o.key?i:"#6B7280",fontWeight:s===o.key?700:500,fontSize:"0.875rem",transition:"all 0.15s"},children:[e.jsx(o.icon,{size:15}),o.label,e.jsx("span",{style:{fontSize:"0.72rem",fontWeight:700,backgroundColor:s===o.key?i+"18":"#F3F4F6",color:s===o.key?i:"#9CA3AF",padding:"1px 7px",borderRadius:20},children:o.count})]},o.key))}),e.jsxs("div",{style:{padding:"10px 28px",backgroundColor:"#F8F9FA",borderBottom:"1px solid #E5E7EB",display:"flex",gap:10,alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:200},children:[e.jsx(H,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9CA3AF"}}),e.jsx("input",{value:p,onChange:o=>E(o.target.value),placeholder:s==="personas"?"Buscar por nombre, email u organizaciÃ³nâ€¦":"Buscar por nombre de organizaciÃ³nâ€¦",style:{width:"100%",paddingLeft:30,paddingRight:12,height:34,border:"1.5px solid #E5E7EB",borderRadius:8,fontSize:"0.84rem",outline:"none",boxSizing:"border-box",backgroundColor:"#fff"}})]}),e.jsxs("select",{value:x===void 0?"":x?"true":"false",onChange:o=>D(o.target.value===""?void 0:o.target.value==="true"),style:{height:34,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.84rem",color:"#374151",cursor:"pointer",backgroundColor:"#fff"},children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"true",children:"Solo activos"}),e.jsx("option",{value:"false",children:"Solo inactivos"})]}),e.jsx("button",{onClick:m,style:{height:34,width:34,border:"1.5px solid #E5E7EB",borderRadius:8,background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(B,{size:14,color:"#6B7280"})})]}),e.jsx("div",{style:{flex:1,overflow:"auto",padding:"20px 28px"},children:R?e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:200,color:"#9CA3AF"},children:[e.jsx(B,{size:18,style:{animation:"spin 1s linear infinite",marginRight:8}})," Cargando clientes..."]}):s==="personas"?y.length===0?e.jsx(A,{icon:u,title:"No hay personas clientes",sub:'RegistrÃ¡ el primero usando "+ Registrar Cliente"'}):e.jsx("div",{style:{backgroundColor:"#fff",borderRadius:12,border:"1px solid #E5E7EB",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{backgroundColor:"#F9FAFB",borderBottom:"1px solid #E5E7EB"},children:["Cliente","Contacto","Tipo","Documento","Alta","Estado"].map(o=>e.jsx("th",{style:{padding:"11px 16px",textAlign:"left",fontWeight:600,color:"#374151",whiteSpace:"nowrap",fontSize:"0.8rem"},children:o},o))})}),e.jsx("tbody",{children:y.map((o,r)=>e.jsxs("tr",{style:{borderBottom:r<y.length-1?"1px solid #F3F4F6":"none"},onMouseEnter:d=>d.currentTarget.style.backgroundColor="#FAFAFA",onMouseLeave:d=>d.currentTarget.style.backgroundColor="",children:[e.jsx("td",{style:{padding:"11px 16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:34,height:34,borderRadius:"50%",backgroundColor:"#FFF7ED",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(u,{size:15,color:i})}),e.jsxs("div",{children:[e.jsxs("p",{style:{margin:0,fontWeight:600,color:"#111827",fontSize:"0.875rem"},children:[o.nombre," ",o.apellido??""]}),o.email&&e.jsx("p",{style:{margin:0,fontSize:"0.76rem",color:"#6B7280"},children:o.email})]})]})}),e.jsx("td",{style:{padding:"11px 16px",color:"#6B7280",fontSize:"0.8rem"},children:o.telefono?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(K,{size:12})," ",o.telefono]}):e.jsx("span",{style:{color:"#D1D5DB"},children:"â€”"})}),e.jsx("td",{style:{padding:"11px 16px"},children:e.jsx("span",{style:{fontSize:"0.76rem",fontWeight:600,backgroundColor:o.tipo==="natural"?"#EFF6FF":"#FFF7ED",color:o.tipo==="natural"?"#3B82F6":i,padding:"3px 10px",borderRadius:20},children:o.tipo==="natural"?"Natural":"JurÃ­dica"})}),e.jsx("td",{style:{padding:"11px 16px",color:"#6B7280",fontSize:"0.8rem"},children:o.documento_tipo&&o.documento_numero?`${o.documento_tipo}: ${o.documento_numero}`:e.jsx("span",{style:{color:"#D1D5DB"},children:"â€”"})}),e.jsx("td",{style:{padding:"11px 16px",color:"#9CA3AF",fontSize:"0.78rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(Q,{size:12}),new Date(o.created_at).toLocaleDateString("es-UY")]})}),e.jsx("td",{style:{padding:"11px 16px"},children:e.jsx("button",{onClick:()=>U(),style:{padding:"3px 10px",borderRadius:20,border:"none",cursor:"pointer",fontSize:"0.76rem",fontWeight:600,backgroundColor:o.activo?"#D1FAE5":"#FEE2E2",color:o.activo?"#10B981":"#EF4444"},children:o.activo?"â— Activo":"â— Inactivo"})})]},o.id))})]})}):e.jsx(A,{icon:j,title:"No hay organizaciones clientes",sub:"Endpoint /api/organizaciones?rol=cliente pendiente"})}),I&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:20},children:e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:16,width:"100%",maxWidth:500,boxShadow:"0 20px 60px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:700,color:"#111827"},children:"Registrar Cliente"}),e.jsx("p",{style:{margin:"2px 0 0",fontSize:"0.78rem",color:"#9CA3AF"},children:"Persona y/u organizaciÃ³n con rol cliente"})]}),e.jsx("button",{onClick:()=>l(!1),style:{background:"none",border:"none",cursor:"pointer",color:"#9CA3AF"},children:e.jsx(Z,{size:20})})]}),e.jsxs("div",{style:{padding:"20px 24px",display:"flex",flexDirection:"column",gap:15},children:[e.jsxs("div",{children:[e.jsxs("label",{style:v,children:["Persona ",e.jsx("span",{style:{color:"#9CA3AF",fontWeight:400},children:"(opcional si hay organizaciÃ³n)"})]}),e.jsxs("select",{value:g.persona_id,onChange:o=>a(r=>({...r,persona_id:o.target.value})),style:w,children:[e.jsx("option",{value:"",children:"â€” Sin persona especÃ­fica â€”"}),z.map(o=>e.jsxs("option",{value:o.id,children:[o.nombre," ",o.apellido??""," ",o.email?`(${o.email})`:""]},o.id))]}),z.length===0&&e.jsxs("p",{style:{margin:"4px 0 0",fontSize:"0.76rem",color:"#F59E0B"},children:["âš ï¸ No hay personas."," ",e.jsx("button",{onClick:()=>{l(!1),c("personas")},style:{background:"none",border:"none",color:i,cursor:"pointer",fontWeight:600,fontSize:"0.76rem",padding:0},children:"Crear una"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:v,children:["OrganizaciÃ³n ",e.jsx("span",{style:{color:"#9CA3AF",fontWeight:400},children:"(opcional si hay persona)"})]}),e.jsxs("select",{value:g.organizacion_id,onChange:o=>a(r=>({...r,organizacion_id:o.target.value})),style:w,children:[e.jsx("option",{value:"",children:"â€” Sin organizaciÃ³n â€”"}),S.map(o=>e.jsx("option",{value:o.id,children:o.nombre},o.id))]}),S.length===0&&e.jsxs("p",{style:{margin:"4px 0 0",fontSize:"0.76rem",color:"#F59E0B"},children:["âš ï¸ No hay organizaciones."," ",e.jsx("button",{onClick:()=>{l(!1),c("organizaciones")},style:{background:"none",border:"none",color:i,cursor:"pointer",fontWeight:600,fontSize:"0.76rem",padding:0},children:"Crear una"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:v,children:"Contexto / Nota"}),e.jsx("input",{value:g.contexto,onChange:o=>a(r=>({...r,contexto:o.target.value})),style:oe,placeholder:"Ej: Canal mayorista, referido porâ€¦"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("input",{type:"checkbox",id:"cli-activo",checked:g.activo,onChange:o=>a(r=>({...r,activo:o.target.checked})),style:{width:16,height:16,accentColor:i,cursor:"pointer"}}),e.jsx("label",{htmlFor:"cli-activo",style:{fontSize:"0.875rem",color:"#374151",cursor:"pointer"},children:"Cliente activo"})]}),e.jsxs("div",{style:{padding:"10px 14px",backgroundColor:"#FFF7ED",borderRadius:8,border:"1px solid #FDBA74",fontSize:"0.78rem",color:"#92400E"},children:["ðŸ’¡ PodÃ©s registrar una ",e.jsx("strong",{children:"persona cliente"}),", una ",e.jsx("strong",{children:"organizaciÃ³n cliente"}),", o ambas en el mismo registro."]})]}),e.jsxs("div",{style:{padding:"14px 24px",borderTop:"1px solid #E5E7EB",display:"flex",justifyContent:"flex-end",gap:10},children:[e.jsx("button",{onClick:()=>l(!1),style:{padding:"9px 20px",borderRadius:8,border:"1.5px solid #E5E7EB",background:"#fff",cursor:"pointer",fontSize:"0.875rem",fontWeight:600,color:"#374151"},children:"Cancelar"}),e.jsxs("button",{onClick:$,disabled:h,style:{padding:"9px 24px",borderRadius:8,border:"none",backgroundColor:i,color:"#fff",cursor:h?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:700,display:"flex",alignItems:"center",gap:6,opacity:h?.7:1},children:[e.jsx(ee,{size:15})," ",h?"Guardandoâ€¦":"Registrar cliente"]})]})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}function A({icon:c,title:t,sub:f}){return e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#9CA3AF"},children:[e.jsx(c,{size:44,style:{marginBottom:12,opacity:.25}}),e.jsx("p",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:t}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:6},children:f})]})}const v={display:"block",fontSize:"0.8rem",fontWeight:600,color:"#374151",marginBottom:5},oe={width:"100%",height:38,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 12px",fontSize:"0.875rem",color:"#111827",outline:"none",boxSizing:"border-box"},w={width:"100%",height:38,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.875rem",color:"#374151",cursor:"pointer",outline:"none"};export{be as ClientesView};
