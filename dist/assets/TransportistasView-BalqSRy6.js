import{s as V,r as s,j as e,R as H,T as L,i as N,f as K}from"./index-Cp81P1X9.js";import{O as M}from"./OrangeHeader-CeXaz2ey.js";import{X as J}from"./x-C6Ysf6Nm.js";import{C as Z}from"./check-BTpxXGEN.js";import{L as Y}from"./loader-circle-CDAiqaDo.js";import{C as Q}from"./chevron-right-DTGMlwIp.js";import{U as ee}from"./users-CjL5MA3J.js";import{M as oe}from"./map-pin-3AxTt9qO.js";import{P as te}from"./plus-ILy5-JQ1.js";import{C as re}from"./clock-Cg5lRJK_.js";import"./zap-MZ_1Pr6Z.js";import"./lightbulb-DmEpsfjr.js";async function O(){const{data:t,error:l}=await V.from("transportistas").select("*").order("nombre");if(l)throw console.error("[transportistasApi] Error obteniendo transportistas:",l),new Error(l.message||"Error cargando transportistas");return t||[]}async function ie(t){const{data:l,error:w}=await V.from("tramos").select("*").eq("transportista_id",t).order("origen");if(w)throw console.error("[transportistasApi] Error obteniendo tramos:",w),new Error(w.message||"Error cargando tramos");return l||[]}function le(){return typeof window>"u"?"#FF6835":getComputedStyle(document.documentElement).getPropertyValue("--color-primary").trim()||"#FF6835"}function ne(t,l){return t<l?"done":t===l?"active":"pending"}function G({field:t,value:l,onChange:w,error:d,primaryColor:j}){var E,k;const x={width:"100%",padding:"10px 12px",border:`1px solid ${d?"#ef4444":"#e2e8f0"}`,borderRadius:"8px",fontSize:"13px",outline:"none",boxSizing:"border-box",fontFamily:"inherit",transition:"all 0.15s",backgroundColor:"#fff"},R={borderColor:j,boxShadow:`0 0 0 3px ${j}1A`},y={borderColor:"#ef4444",boxShadow:"0 0 0 3px rgba(239,68,68,0.1)"},[p,g]=s.useState(!1),h=m=>{w(m)},z={...x,...p&&!d?R:{},...d?y:{}};switch(t.type){case"textarea":return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"6px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"2px"},children:"*"})]}),e.jsx("textarea",{value:String(l||""),onChange:n=>h(n.target.value),onFocus:()=>g(!0),onBlur:()=>g(!1),placeholder:t.placeholder,required:t.required,rows:4,style:{...z,resize:"vertical",fontFamily:"inherit"}}),t.hint&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#94a3b8"},children:t.hint}),d&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#ef4444"},children:d})]});case"select":return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"6px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"2px"},children:"*"})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("select",{value:String(l||""),onChange:n=>h(n.target.value),onFocus:()=>g(!0),onBlur:()=>g(!1),required:t.required,style:{...z,appearance:"none",paddingRight:"36px",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"Seleccionar..."}),(E=t.options)==null?void 0:E.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(Q,{size:16,color:"#94a3b8",style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%) rotate(90deg)",pointerEvents:"none"}})]}),t.hint&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#94a3b8"},children:t.hint}),d&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#ef4444"},children:d})]});case"toggle":const m=!!l;return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[e.jsx("div",{style:{width:"44px",height:"24px",borderRadius:"12px",backgroundColor:m?j:"#cbd5e1",display:"flex",alignItems:"center",padding:"2px",transition:"all 0.2s",position:"relative"},children:e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#fff",transform:m?"translateX(20px)":"translateX(0)",transition:"transform 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"12px",fontWeight:600,color:"#475569"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"2px"},children:"*"})]}),t.helpText&&e.jsx("p",{style:{margin:"2px 0 0",fontSize:"11px",color:"#94a3b8"},children:t.helpText})]})]}),e.jsx("input",{type:"checkbox",checked:m,onChange:n=>h(n.target.checked),style:{display:"none"}}),d&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#ef4444"},children:d})]});case"multicheck":const T=Array.isArray(l)?l:[];return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"6px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"2px"},children:"*"})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:(k=t.options)==null?void 0:k.map(n=>{const v=T.includes(n.value);return e.jsx("button",{type:"button",onClick:()=>{const o=v?T.filter(c=>c!==n.value):[...T,n.value];h(o)},style:{padding:"6px 12px",borderRadius:"20px",border:`1px solid ${v?j:"#e2e8f0"}`,backgroundColor:v?`${j}15`:"#fff",color:v?j:"#475569",fontSize:"12px",fontWeight:600,cursor:"pointer",transition:"all 0.15s",outline:"none"},children:n.label},n.value)})}),t.hint&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#94a3b8"},children:t.hint}),d&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#ef4444"},children:d})]});case"image":const[C,B]=s.useState(typeof l=="string"&&l?l:null),S=s.useRef(null),D=n=>{var o;const v=(o=n.target.files)==null?void 0:o[0];if(v){const c=new FileReader;c.onloadend=()=>{const b=c.result;B(b),h(b)},c.readAsDataURL(v)}};return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"6px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"2px"},children:"*"})]}),e.jsxs("div",{onClick:()=>{var n;return(n=S.current)==null?void 0:n.click()},style:{border:"2px dashed #e2e8f0",borderRadius:"8px",padding:"24px",textAlign:"center",cursor:"pointer",transition:"all 0.15s",backgroundColor:C?"#f8fafc":"#fff"},onMouseEnter:n=>{C||(n.currentTarget.style.borderColor=j,n.currentTarget.style.backgroundColor="#f8fafc")},onMouseLeave:n=>{C||(n.currentTarget.style.borderColor="#e2e8f0",n.currentTarget.style.backgroundColor="#fff")},children:[e.jsx("input",{ref:S,type:"file",accept:"image/*",onChange:D,style:{display:"none"}}),C?e.jsxs("div",{children:[e.jsx("img",{src:C,alt:"Preview",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"8px"}}),e.jsx("p",{style:{fontSize:"11px",color:"#94a3b8",margin:0},children:"Click para cambiar imagen"})]}):e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"13px",color:"#475569",margin:"0 0 4px",fontWeight:600},children:"Arrastra una imagen aquÃ­ o click para seleccionar"}),e.jsx("p",{style:{fontSize:"11px",color:"#94a3b8",margin:0},children:t.hint||"JPG, PNG, PDF hasta 10MB"})]})]}),d&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#ef4444"},children:d})]});default:return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"6px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"2px"},children:"*"})]}),e.jsx("input",{type:t.type,value:String(l||""),onChange:n=>h(n.target.value),onFocus:()=>g(!0),onBlur:()=>g(!1),placeholder:t.placeholder,required:t.required,style:z}),t.hint&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#94a3b8"},children:t.hint}),d&&e.jsx("p",{style:{margin:"4px 0 0",fontSize:"11px",color:"#ef4444"},children:d})]})}}function ae({open:t,onClose:l,onSave:w,title:d,icon:j,sheets:x,initialData:R={},loading:y=!1}){const[p,g]=s.useState(0),[h,z]=s.useState(R),[E,k]=s.useState({}),[m,T]=s.useState(!1),[C,B]=s.useState(null),[S,D]=s.useState("#FF6835"),n=s.useRef(null);s.useEffect(()=>{D(le())},[]),s.useEffect(()=>{t&&(g(0),z(R),k({}),B(null))},[t,R]),s.useEffect(()=>{if(!t)return;const r=u=>{u.key==="Escape"&&l()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,l]),s.useEffect(()=>{if(!t||!n.current)return;const u=n.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),a=u[0],f=u[u.length-1],A=X=>{X.key==="Tab"&&(X.shiftKey?document.activeElement===a&&(X.preventDefault(),f==null||f.focus()):document.activeElement===f&&(X.preventDefault(),a==null||a.focus()))};return document.addEventListener("keydown",A),a==null||a.focus(),()=>document.removeEventListener("keydown",A)},[t,p]);const v=s.useCallback((r,u)=>{z(a=>({...a,[r]:u})),E[r]&&k(a=>{const f={...a};return delete f[r],f})},[E]),o=s.useCallback(r=>{const u=x[r];if(!u)return!0;const a={};return u.fields.forEach(f=>{if(f.required){const A=h[f.id];(A==null||A===""||Array.isArray(A)&&A.length===0)&&(a[f.id]=`${f.label} es requerido`)}}),k(a),Object.keys(a).length===0},[x,h]),c=s.useCallback(()=>{o(p)&&p<x.length-1&&g(p+1)},[p,x,o]),b=s.useCallback(()=>{p>0&&g(p-1)},[p]),W=s.useCallback(r=>{if(r<=p+1&&r>=0&&r<x.length){if(r===p+1&&!o(p))return;g(r)}},[p,x,o]),_=s.useCallback(async()=>{if(!o(x.length-1)){g(x.length-1);return}T(!0),B(null);try{await w(h),l()}catch(r){B(r instanceof Error?r.message:"Error al guardar")}finally{T(!1)}},[h,w,l,x,o]);if(!t)return null;const i=x[p],I=p===0,q=p===x.length-1,P={},$=[];return i.fields.forEach(r=>{r.row?(P[r.row]||(P[r.row]=[]),P[r.row].push(r)):$.push(r)}),e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:l,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15,23,42,0.45)",backdropFilter:"blur(2px)",zIndex:9998,animation:"fadeIn 0.3s ease"}}),e.jsxs("div",{ref:n,style:{position:"fixed",top:0,right:t?0:"-500px",width:"500px",maxWidth:"100vw",height:"100vh",backgroundColor:"#fff",boxShadow:"-8px 0 40px rgba(0,0,0,0.18)",zIndex:9999,display:"flex",flexDirection:"column",transition:"right 0.3s ease"},children:[e.jsxs("div",{style:{padding:"18px 24px",borderBottom:"1px solid #e2e8f0",flexShrink:0,display:"flex",alignItems:"center",gap:"12px"},children:[j&&e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"#FFF7ED",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(j,{size:20,color:S})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[e.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:700,color:"#111827"},children:d}),I&&e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#ef4444",backgroundColor:"#FEE2E2",padding:"2px 6px",borderRadius:"4px"},children:"â— Obligatorios en pÃ¡g. 1"})]}),i.subtitle&&e.jsx("p",{style:{margin:"2px 0 0",fontSize:"12px",color:"#6B7280"},children:i.subtitle})]}),e.jsx("button",{onClick:l,style:{width:"32px",height:"32px",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",flexShrink:0,transition:"all 0.15s"},onMouseEnter:r=>{r.currentTarget.style.backgroundColor="#f1f5f9"},onMouseLeave:r=>{r.currentTarget.style.backgroundColor="transparent"},children:e.jsx(J,{size:16,color:"#475569"})})]}),e.jsx("div",{style:{padding:"16px 24px",borderBottom:"1px solid #f1f5f9",flexShrink:0,overflowX:"auto"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:x.map((r,u)=>{const a=ne(u,p),f=u<=p+1;return e.jsxs(H.Fragment,{children:[e.jsxs("button",{type:"button",onClick:()=>W(u),disabled:!f,style:{display:"flex",alignItems:"center",gap:"8px",border:"none",backgroundColor:"transparent",cursor:f?"pointer":"not-allowed",padding:"4px 0",opacity:f?1:.5},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:700,flexShrink:0,backgroundColor:a==="done"?"#ECFDF5":a==="active"?S:"#f1f5f9",color:a==="done"?"#059669":a==="active"?"#fff":"#94a3b8"},children:a==="done"?e.jsx(Z,{size:12}):u+1}),e.jsx("span",{style:{fontSize:"12px",fontWeight:a==="active"?700:500,color:a==="active"?"#111827":a==="done"?"#059669":"#94a3b8",whiteSpace:"nowrap"},children:r.title})]}),u<x.length-1&&e.jsx("div",{style:{width:"16px",height:"1px",backgroundColor:"#e2e8f0",flexShrink:0}})]},r.id)})})}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"24px",display:"flex",flexDirection:"column",gap:"18px"},children:[Object.entries(P).map(([r,u])=>e.jsx("div",{style:{display:"flex",gap:"16px"},children:u.map(a=>e.jsx("div",{style:{flex:1},children:e.jsx(G,{field:a,value:h[a.id],onChange:f=>v(a.id,f),error:E[a.id],primaryColor:S})},a.id))},r)),$.map(r=>e.jsx(G,{field:r,value:h[r.id],onChange:u=>v(r.id,u),error:E[r.id],primaryColor:S},r.id))]}),e.jsxs("div",{style:{padding:"14px 24px",borderTop:"1px solid #e2e8f0",flexShrink:0,display:"flex",alignItems:"center",gap:"10px",backgroundColor:"#fff"},children:[e.jsx("button",{type:"button",onClick:l,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"8px",backgroundColor:"#fff",color:"#475569",fontSize:"13px",fontWeight:600,cursor:"pointer",transition:"all 0.15s"},onMouseEnter:r=>{r.currentTarget.style.backgroundColor="#f8fafc"},onMouseLeave:r=>{r.currentTarget.style.backgroundColor="#fff"},children:"Cancelar"}),!I&&e.jsx("button",{type:"button",onClick:b,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"8px",backgroundColor:"#fff",color:"#475569",fontSize:"13px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.15s"},onMouseEnter:r=>{r.currentTarget.style.backgroundColor="#f8fafc"},onMouseLeave:r=>{r.currentTarget.style.backgroundColor="#fff"},children:"â† Ant."}),e.jsxs("div",{style:{flex:1,textAlign:"center",fontSize:"12px",color:"#94a3b8"},children:["PÃ¡gina ",p+1," de ",x.length]}),!q&&e.jsx("button",{type:"button",onClick:c,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"8px",backgroundColor:"#fff",color:"#475569",fontSize:"13px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.15s"},onMouseEnter:r=>{r.currentTarget.style.backgroundColor="#f8fafc"},onMouseLeave:r=>{r.currentTarget.style.backgroundColor="#fff"},children:"Sig. â†’"}),q&&e.jsx("button",{type:"button",onClick:_,disabled:m||y,style:{padding:"8px 20px",border:"none",borderRadius:"8px",backgroundColor:m||y?"#cbd5e1":S,color:"#fff",fontSize:"13px",fontWeight:700,cursor:m||y?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.15s"},children:m||y?e.jsxs(e.Fragment,{children:[e.jsx(Y,{size:14,style:{animation:"spin 1s linear infinite"}}),"Guardando..."]}):e.jsx(e.Fragment,{children:"ðŸ’¾ Guardar"})}),C&&e.jsxs("div",{style:{position:"absolute",bottom:"60px",left:"24px",right:"24px",padding:"10px 14px",backgroundColor:"#FEE2E2",color:"#DC2626",borderRadius:"8px",fontSize:"12px",fontWeight:600,border:"1px solid #FECACA"},children:["âš  ",C]})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}const F="#FF6835",se=[{id:"general",title:"General",subtitle:"Datos generales Â· InformaciÃ³n principal del carrier",fields:[{id:"nombre",label:"Nombre del carrier",type:"text",required:!0,placeholder:"Ej: Transporte del Sur SRL"},{id:"tipo",label:"Tipo",type:"select",required:!0,options:[{value:"propio",label:"Propio"},{value:"tercero",label:"Tercero"},{value:"courier",label:"Courier"},{value:"nacional",label:"Nacional"},{value:"internacional",label:"Internacional"}],row:"row1"},{id:"estado",label:"Estado",type:"select",required:!0,options:[{value:"activo",label:"Activo"},{value:"inactivo",label:"Inactivo"}],row:"row1"},{id:"logo",label:"Logo / Imagen",type:"image"},{id:"activo",label:"Carrier activo",type:"toggle",helpText:"Visible para asignaciÃ³n de envÃ­os"}]},{id:"contacto",title:"Contacto",subtitle:"Contacto Â· Persona y medios de comunicaciÃ³n",fields:[{id:"contacto_nombre",label:"Nombre completo",type:"text",placeholder:"Ej: Juan PÃ©rez"},{id:"email",label:"Email",type:"email",placeholder:"contacto@empresa.com",row:"row1"},{id:"telefono",label:"TelÃ©fono",type:"tel",placeholder:"09X XXX XXX",row:"row1"},{id:"rut",label:"Documento / RUT",type:"text",placeholder:"XX.XXX.XXX-X",row:"row2"},{id:"cargo",label:"Cargo",type:"text",placeholder:"Ej: Gerente logÃ­stica",row:"row2"},{id:"web",label:"Sitio web",type:"url",placeholder:"https://empresa.com",row:"row3"},{id:"whatsapp",label:"WhatsApp",type:"tel",placeholder:"598 9X XXX XXX",row:"row3"}]},{id:"direccion",title:"DirecciÃ³n",subtitle:"DirecciÃ³n y cobertura Â· UbicaciÃ³n y zonas operativas",fields:[{id:"calle",label:"Calle y nÃºmero",type:"text",placeholder:"Ej: Av. Italia 2500",hint:"ðŸ’¡ CompletÃ¡ la direcciÃ³n y validamos con Google Maps"},{id:"ciudad",label:"Ciudad",type:"text",placeholder:"Montevideo",row:"row1"},{id:"cp",label:"CÃ³digo postal",type:"text",placeholder:"11300",row:"row1"},{id:"departamento",label:"Departamento / Estado",type:"text",placeholder:"Montevideo",row:"row2"},{id:"pais",label:"PaÃ­s",type:"select",options:[{value:"uy",label:"Uruguay"},{value:"ar",label:"Argentina"},{value:"br",label:"Brasil"}],row:"row2"},{id:"tramos",label:"Tramos habilitados",type:"multicheck",options:[{value:"local",label:"Local"},{value:"intercity",label:"Intercity"},{value:"internacional",label:"Internacional"},{value:"last_mile",label:"Last mile"}]}]},{id:"depositos",title:"DepÃ³sitos",subtitle:"DepÃ³sitos y horarios Â· Instalaciones y disponibilidad",fields:[{id:"depositos_ids",label:"DepÃ³sitos asociados",type:"text",placeholder:"Se conectarÃ¡ a datos reales",hint:"PrÃ³ximamente: selector de depÃ³sitos existentes"},{id:"horario_lv_desde",label:"Lun-Vie desde",type:"time",row:"row1"},{id:"horario_lv_hasta",label:"Lun-Vie hasta",type:"time",row:"row1"},{id:"horario_sab_desde",label:"SÃ¡bado desde",type:"time",row:"row2"},{id:"horario_sab_hasta",label:"SÃ¡bado hasta",type:"time",row:"row2"}]},{id:"tarifas",title:"Tarifas",subtitle:"Tarifas y configuraciÃ³n Â· Costos y condiciones",fields:[{id:"tarifa_base",label:"Tarifa base",type:"number",placeholder:"0.00",row:"row1"},{id:"moneda",label:"Moneda",type:"select",options:[{value:"UYU",label:"UYU"},{value:"USD",label:"USD"},{value:"ARS",label:"ARS"}],row:"row1"},{id:"tiempo_entrega",label:"Tiempo promedio entrega",type:"text",placeholder:"Ej: 24-48hs",row:"row2"},{id:"rating",label:"Rating inicial",type:"number",placeholder:"0.0",row:"row2"},{id:"notas",label:"Observaciones",type:"textarea",placeholder:"Condiciones especiales, acuerdos, notas..."}]},{id:"documentos",title:"Docs",subtitle:"Documentos Â· Contratos y habilitaciones",fields:[{id:"doc_contrato",label:"Contrato de servicio",type:"image",hint:"PDF, DOC hasta 10MB"},{id:"doc_habilitacion",label:"HabilitaciÃ³n / Licencia",type:"image",hint:"PDF, JPG, PNG hasta 10MB"},{id:"doc_tarifario",label:"Tarifario completo",type:"image",hint:"PDF, XLS, CSV hasta 10MB"}]}],U={local:{label:"Local",color:"#059669",bg:"#ECFDF5"},nacional:{label:"Nacional",color:"#2563EB",bg:"#EFF6FF"},intercity:{label:"Intercity",color:"#7C3AED",bg:"#F5F3FF"},internacional:{label:"Internacional",color:"#D97706",bg:"#FFFBEB"},propio:{label:"Propio",color:"#059669",bg:"#ECFDF5"},tercero:{label:"Tercero",color:"#2563EB",bg:"#EFF6FF"},courier:{label:"Courier",color:"#7C3AED",bg:"#F5F3FF"}};function de({n:t}){return e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"2px"},children:[[1,2,3,4,5].map(l=>e.jsx(N,{size:11,color:l<=Math.round(t)?"#F59E0B":"#E5E7EB",fill:l<=Math.round(t)?"#F59E0B":"none"},l)),e.jsx("span",{style:{fontSize:"11px",color:"#6B7280",marginLeft:"3px"},children:t})]})}function Ce({onNavigate:t}){const[l,w]=s.useState("transportistas"),[d,j]=s.useState(""),[x,R]=s.useState(null),[y,p]=s.useState([]),[g,h]=s.useState([]),[z,E]=s.useState(!1),[k,m]=s.useState(null),[T,C]=s.useState(!1);s.useEffect(()=>{B()},[]);const B=async()=>{E(!0),m(null);try{const[o,c]=await Promise.all([O(),Promise.all((await O()).map(i=>ie(i.id))).then(i=>i.flat())]),b=o.map(i=>({id:i.id,nombre:i.nombre,tipo:i.tipo,logo:i.logo,contacto:i.contacto,email:i.email,telefono:i.telefono,rating:i.rating||0,enviosActivos:i.envios_activos||0,enviosTotales:i.envios_totales||0,activo:i.activo??i.estado==="activo",tiempoPromedio:i.tiempo_promedio,cobertura:Array.isArray(i.cobertura)?i.cobertura:[]})),W=new Map(o.map(i=>[i.id,i])),_=c.map(i=>{var I;return{id:i.id,carrierId:i.transportista_id,carrier:((I=W.get(i.transportista_id))==null?void 0:I.nombre)||"",origen:i.origen,destino:i.destino,tipo:i.tipo,tiempoEstimado:i.tiempo_estimado,tarifaBase:i.tarifa_base,tarifaKg:i.tarifa_kg,activo:i.activo??i.estado==="activo"}});p(b),h(_)}catch(o){m(o instanceof Error?o.message:"Error cargando datos"),console.error("Error cargando transportistas:",o)}finally{E(!1)}},S=y.filter(o=>o.activo).length,D=y.reduce((o,c)=>o+(c.enviosActivos||0),0),n=y.filter(o=>!d||o.nombre.toLowerCase().includes(d.toLowerCase())),v=g.filter(o=>!d||o.carrier.toLowerCase().includes(d.toLowerCase())||o.origen.toLowerCase().includes(d.toLowerCase())||o.destino.toLowerCase().includes(d.toLowerCase()));return z?e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx(M,{icon:L,title:"Transportistas",subtitle:"Cargando...",actions:[{label:"â† LogÃ­stica",onClick:()=>t("logistica")}]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Y,{size:32,color:F,style:{animation:"spin 1s linear infinite"}})})]}):k?e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:e.jsx(M,{icon:L,title:"Transportistas",subtitle:`Error: ${k}`,actions:[{label:"â† LogÃ­stica",onClick:()=>t("logistica")},{label:"â†» Reintentar",primary:!0,onClick:B}]})}):e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx(M,{icon:L,title:"Transportistas",subtitle:`${S} carriers activos Â· ${D} envÃ­os en curso`,actions:[{label:"â† LogÃ­stica",onClick:()=>t("logistica")},{label:"+ Nuevo Carrier",primary:!0,onClick:()=>C(!0)}]}),e.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",backgroundColor:"#F8F9FA"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:"12px",padding:"20px 20px 0"},children:[{label:"Carriers Activos",value:S,icon:ee,color:F},{label:"EnvÃ­os en curso",value:D,icon:L,color:"#2563EB"},{label:"Tramos configurados",value:g.filter(o=>o.activo).length,icon:oe,color:"#7C3AED"},{label:"Rating promedio",value:y.length>0?(y.reduce((o,c)=>o+(c.rating||0),0)/y.length).toFixed(1)+"â˜…":"0â˜…",icon:N,color:"#F59E0B"}].map(o=>{const c=o.icon;return e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"16px",display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:`${o.color}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(c,{size:18,color:o.color})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"20px",fontWeight:800,color:"#111"},children:o.value}),e.jsx("div",{style:{fontSize:"11px",color:"#6B7280"},children:o.label})]})]},o.label)})}),e.jsxs("div",{style:{display:"flex",gap:"0",padding:"16px 20px 0",borderBottom:"1px solid #E5E7EB",backgroundColor:"#fff",marginTop:"16px"},children:[[["transportistas","Transportistas"],["tramos","Tramos & Zonas"],["tarifas","Simulador de Tarifas"]].map(([o,c])=>e.jsx("button",{onClick:()=>w(o),style:{padding:"10px 20px",border:"none",backgroundColor:"transparent",cursor:"pointer",fontSize:"13px",fontWeight:l===o?700:500,color:l===o?F:"#6B7280",borderBottom:l===o?`2px solid ${F}`:"2px solid transparent",transition:"all 0.15s"},children:c},o)),e.jsx("div",{style:{flex:1}}),e.jsxs("div",{style:{position:"relative",padding:"6px 0"},children:[e.jsx(K,{size:13,color:"#9CA3AF",style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)"}}),e.jsx("input",{value:d,onChange:o=>j(o.target.value),placeholder:"Buscar...",style:{paddingLeft:"30px",paddingRight:"12px",paddingTop:"7px",paddingBottom:"7px",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px",outline:"none",width:"180px"}})]})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px 20px"},children:[l==="transportistas"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(340px,1fr))",gap:"12px"},children:[n.map(o=>{const c=U[o.tipo]??{label:o.tipo,color:"#6B7280",bg:"#F3F4F6"},b=(x==null?void 0:x.id)===o.id;return e.jsxs("div",{onClick:()=>R(b?null:o),style:{backgroundColor:"#fff",borderRadius:"12px",border:`1.5px solid ${b?F:o.activo?"#E5E7EB":"#F3F4F6"}`,padding:"18px",cursor:"pointer",opacity:o.activo?1:.6,boxShadow:b?`0 0 0 3px ${F}22`:"0 1px 4px rgba(0,0,0,0.04)",transition:"all 0.15s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",backgroundColor:"#F3F4F6",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"22px",flexShrink:0},children:o.logo}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:800,color:"#111"},children:o.nombre}),e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:c.color,backgroundColor:c.bg,padding:"2px 7px",borderRadius:"10px"},children:c.label}),!o.activo&&e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:"#9CA3AF",backgroundColor:"#F3F4F6",padding:"2px 7px",borderRadius:"10px"},children:"Inactivo"})]}),e.jsx(de,{n:o.rating||0})]}),e.jsx("div",{style:{width:"36px",height:"20px",borderRadius:"10px",backgroundColor:o.activo?"#D1FAE5":"#F3F4F6",display:"flex",alignItems:"center",padding:"0 2px",cursor:"pointer",flexShrink:0,justifyContent:o.activo?"flex-end":"flex-start"},children:e.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:o.activo?"#059669":"#9CA3AF"}})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"12px"},children:[e.jsxs("div",{style:{fontSize:"11px",color:"#6B7280"},children:["â± ",o.tiempoPromedio||"â€”"]}),e.jsxs("div",{style:{fontSize:"11px",color:"#6B7280"},children:["ðŸ“¦ ",o.enviosActivos||0," activos"]}),e.jsxs("div",{style:{fontSize:"11px",color:"#6B7280"},children:["ðŸ“Š ",o.enviosTotales||0," totales"]}),e.jsxs("div",{style:{fontSize:"11px",color:"#6B7280"},children:["â˜Ž ",o.telefono||"â€”"]})]}),o.cobertura&&o.cobertura.length>0&&e.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:o.cobertura.map(W=>e.jsx("span",{style:{fontSize:"10px",color:"#374151",backgroundColor:"#F3F4F6",padding:"2px 7px",borderRadius:"6px"},children:W},W))})]},o.id)}),e.jsxs("div",{onClick:()=>C(!0),style:{backgroundColor:"#FAFAFA",borderRadius:"12px",border:"2px dashed #E5E7EB",padding:"24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",minHeight:"160px"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"50%",backgroundColor:"#FFF4EC",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(te,{size:22,color:F})}),e.jsx("span",{style:{fontSize:"13px",fontWeight:700,color:F},children:"Agregar Carrier"}),e.jsx("span",{style:{fontSize:"11px",color:"#9CA3AF",textAlign:"center"},children:"Conectar nuevo transportista al sistema"})]})]}),l==="tramos"&&e.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{backgroundColor:"#F9FAFB"},children:["Carrier","Origen","Destino","Tipo","Tiempo Est.","Tarifa Base","$/Kg","Estado"].map(o=>e.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontSize:"11px",fontWeight:700,color:"#6B7280",textTransform:"uppercase",letterSpacing:"0.05em",borderBottom:"1px solid #E5E7EB"},children:o},o))})}),e.jsx("tbody",{children:v.map((o,c)=>{const b=U[o.tipo]??{label:o.tipo,color:"#6B7280",bg:"#F3F4F6"};return e.jsxs("tr",{style:{borderBottom:c<v.length-1?"1px solid #F3F4F6":"none"},children:[e.jsx("td",{style:{padding:"12px 14px",fontSize:"13px",fontWeight:600,color:"#374151"},children:o.carrier}),e.jsx("td",{style:{padding:"12px 14px",fontSize:"12px",color:"#6B7280"},children:o.origen}),e.jsx("td",{style:{padding:"12px 14px",fontSize:"12px",color:"#374151",fontWeight:500},children:o.destino}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:b.color,backgroundColor:b.bg,padding:"3px 8px",borderRadius:"10px"},children:b.label})}),e.jsxs("td",{style:{padding:"12px 14px",fontSize:"12px",color:"#374151",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(re,{size:11,color:"#9CA3AF"})," ",o.tiempoEstimado||"â€”"]}),e.jsxs("td",{style:{padding:"12px 14px",fontSize:"13px",fontWeight:700,color:"#111"},children:["$",(o.tarifaBase||0).toLocaleString("es-AR")]}),e.jsxs("td",{style:{padding:"12px 14px",fontSize:"12px",color:"#6B7280"},children:["$",o.tarifaKg||0,"/kg"]}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:"10px",fontWeight:700,color:o.activo?"#059669":"#9CA3AF",backgroundColor:o.activo?"#ECFDF5":"#F3F4F6",padding:"3px 8px",borderRadius:"10px"},children:o.activo?"â— Activo":"â—‹ Inactivo"})})]},o.id)})})]})}),l==="tarifas"&&e.jsx("div",{style:{maxWidth:"560px"},children:e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"24px"},children:[e.jsx("h3",{style:{margin:"0 0 20px",fontSize:"15px",fontWeight:800,color:"#111"},children:"Simulador de Tarifa de EnvÃ­o"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"14px"},children:[[{label:"Peso (kg)",type:"number",placeholder:"Ej: 2.5"},{label:"Volumen (mÂ³)",type:"number",placeholder:"Ej: 0.02"},{label:"CÃ³digo Postal Origen",type:"text",placeholder:"Ej: C1001"},{label:"CÃ³digo Postal Destino",type:"text",placeholder:"Ej: 5000"}].map(o=>e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:700,color:"#374151",marginBottom:"6px"},children:o.label}),e.jsx("input",{type:o.type,placeholder:o.placeholder,style:{width:"100%",padding:"10px 12px",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"13px",outline:"none",boxSizing:"border-box"}})]},o.label)),e.jsx("button",{style:{marginTop:"6px",padding:"12px",border:"none",borderRadius:"10px",backgroundColor:F,color:"#fff",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"Calcular tarifas disponibles"})]}),e.jsxs("div",{style:{marginTop:"20px",padding:"14px",backgroundColor:"#F9FAFB",borderRadius:"10px",border:"1px solid #E5E7EB"},children:[e.jsx("p",{style:{margin:"0 0 10px",fontSize:"12px",fontWeight:700,color:"#374151"},children:"Tarifas estimadas:"}),[{carrier:"Express Delivery GBA",tiempo:"Same day",precio:1400},{carrier:"OCA",tiempo:"24-48h",precio:1680},{carrier:"Correo Argentino",tiempo:"3-4 dÃ­as",precio:2450},{carrier:"Andreani",tiempo:"2-3 dÃ­as",precio:2750}].map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #E5E7EB"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",fontWeight:600,color:"#111"},children:o.carrier}),e.jsx("div",{style:{fontSize:"11px",color:"#9CA3AF"},children:o.tiempo})]}),e.jsxs("div",{style:{fontSize:"14px",fontWeight:800,color:F},children:["$",o.precio.toLocaleString("es-AR")]})]},o.carrier))]})]})})]})]}),e.jsx(ae,{open:T,onClose:()=>C(!1),onSave:async o=>{console.log("[TransportistasView] Guardar transportista:",o)},title:"Nuevo Carrier",icon:L,sheets:se})]})}export{Ce as TransportistasView};
