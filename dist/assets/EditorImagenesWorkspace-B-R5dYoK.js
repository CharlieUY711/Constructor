import{c as B,r as h,j as e}from"./index-CBzyT8Xh.js";import{W as Ge}from"./WorkspaceShell-C2FmVU_d.js";import{D as _e}from"./download-74E3owa-.js";import{X as De}from"./x-CPklgR5c.js";import{S as Ke}from"./square-check-big-B0kDcXLs.js";import{B as Pe,I as Ve}from"./italic-B1yr8LV6.js";import{R as Qe}from"./rotate-ccw-Db1WxQr5.js";import{T as Ue}from"./type-C8xwDUtT.js";import{T as Je}from"./trash-2-D8v1H4Ov.js";import{U as et}from"./upload-B3yPRrI-.js";import{M as tt}from"./mouse-pointer-Cw6dYiYu.js";import{L as nt}from"./lock-ZkkOnxrD.js";import{Z as ot}from"./zap-DfkAaHqc.js";import{P as ke}from"./plus-DpTbYOO-.js";import"./arrow-left-BIx2xSIP.js";import"./printer-Djr3IHwF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],it=B("align-center",rt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],at=B("align-left",st);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],ct=B("align-right",lt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]],ht=B("crop",dt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],ut=B("droplets",pt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]],ft=B("eraser",xt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]],yt=B("flip-horizontal",gt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["path",{d:"M21 8V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v3",key:"14bfxa"}],["path",{d:"M21 16v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3",key:"14rx03"}],["path",{d:"M4 12H2",key:"rhcxmi"}],["path",{d:"M10 12H8",key:"s88cx1"}],["path",{d:"M16 12h-2",key:"10asgb"}],["path",{d:"M22 12h-2",key:"14jgyd"}]],bt=B("flip-vertical",mt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],Ft=B("hand",jt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Xe=B("loader",kt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],vt=B("move",Ct);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=[["path",{d:"m2 22 1-1h3l9-9",key:"1sre89"}],["path",{d:"M3 21v-3l9-9",key:"hpe2y6"}],["path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z",key:"196du1"}]],wt=B("pipette",St);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],zt=B("rotate-cw",Et);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Bt=B("square",Mt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],It=B("underline",At);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],$t=B("undo-2",Rt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Wt=B("zoom-in",Dt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Nt=B("zoom-out",_t),$={brightness:100,contrast:100,saturation:100,hue:0,blur:0,sepia:0,opacity:100},We=[{id:"square",name:"Web Cuadrado",w:1200,h:1200,shape:"rect",desc:"1200 Ã— 1200"},{id:"story",name:"Story 9:10",w:1080,h:1200,shape:"rect",desc:"1080 Ã— 1200"},{id:"header",name:"Encabezado",w:1200,h:400,shape:"rect",desc:"1200 Ã— 400"},{id:"footer",name:"Pie",w:1200,h:300,shape:"rect",desc:"1200 Ã— 300"},{id:"label",name:"Etiq. EnvÃ­o",w:150,h:100,shape:"rect",desc:"150 Ã— 100 mm"},{id:"circle",name:"Circular",w:1200,h:1200,shape:"circle",desc:"â­• 1200Ã—1200"}],Le=[{name:"Original",values:$},{name:"VÃ­vido",values:{...$,brightness:110,contrast:115,saturation:150}},{name:"Cool",values:{...$,hue:190,saturation:120}},{name:"CÃ¡lido",values:{...$,hue:20,brightness:105,saturation:110}},{name:"B&N",values:{...$,saturation:0}},{name:"Vintage",values:{...$,sepia:60,contrast:90,brightness:95}},{name:"Fade",values:{...$,contrast:80,brightness:105,saturation:80,opacity:90}},{name:"Noir",values:{...$,saturation:0,contrast:130,brightness:90}}],Ht=["Arial","Georgia","Verdana","Courier New","Impact","Trebuchet MS","Palatino","Tahoma"],Se=["Original","Auto","V1","V2","V3","V4"],Lt=[nt,ot,ke,ke,ke,ke],Tt=[{id:"select",Icon:tt,tip:"SelecciÃ³n (V)"},{id:"crop",Icon:ht,tip:"Recorte (C)"},{id:"transform",Icon:vt,tip:"Transformar (T)"},{id:"pan",Icon:Ft,tip:"Mano (H)"},{id:"text",Icon:Ue,tip:"Texto (X)"},{id:"eyedrop",Icon:wt,tip:"Cuentagotas (E)"},{id:"watermark",Icon:ut,tip:"Marca de agua"}];function Ne(l){return`brightness(${l.brightness}%) contrast(${l.contrast}%) saturate(${l.saturation}%) hue-rotate(${l.hue}deg) blur(${l.blur}px) sepia(${l.sepia}%) opacity(${l.opacity}%)`}function Ye(l,c){return c===0?l:Ye(c,l%c)}function Ze(l,c){const x=Ye(l,c),v=l/x,d=c/x;return v>20||d>20?`${(l/c).toFixed(2)}:1`:`${v}:${d}`}function Te(){return Math.random().toString(36).slice(2,9)}async function qe(l,c=58){return new Promise((x,v)=>{const d=new Image;d.onload=()=>{const g=Math.min(1,2e3/Math.max(d.naturalWidth,d.naturalHeight)),r=Math.round(d.naturalWidth*g),i=Math.round(d.naturalHeight*g),p=document.createElement("canvas");p.width=r,p.height=i;const b=p.getContext("2d",{willReadFrequently:!0});b.drawImage(d,0,0,r,i);const S=b.getImageData(0,0,r,i),k=S.data,u=[],f=(n,M)=>{const E=(M*r+n)*4;u.push([k[E],k[E+1],k[E+2]])};for(let n=0;n<r;n++)f(n,0),f(n,i-1);for(let n=1;n<i-1;n++)f(0,n),f(r-1,n);u.sort((n,M)=>.299*n[0]+.587*n[1]+.114*n[2]-(.299*M[0]+.587*M[1]+.114*M[2]));const[o,w,z]=u[u.length>>1],m=n=>{const M=k[n]-o,E=k[n+1]-w,O=k[n+2]-z;return Math.sqrt(M*M+E*E+O*O)},A=new Uint8Array(r*i),T=new Int32Array(r*i*2);let q=0,H=0;const W=n=>{n>=0&&n<r*i&&!A[n]&&(A[n]=1,T[H++]=n)};for(let n=0;n<r;n++)W(n),W((i-1)*r+n);for(let n=1;n<i-1;n++)W(n*r),W(n*r+r-1);for(;q<H;){const n=T[q++],M=n%r,E=n/r|0;m(n*4)<=c&&(k[n*4+3]=0,M>0&&W(n-1),M<r-1&&W(n+1),E>0&&W(n-r),E<i-1&&W(n+r))}const N=new Uint8Array(r*i);for(let n=0;n<r*i;n++)N[n]=k[n*4+3];for(let n=1;n<i-1;n++)for(let M=1;M<r-1;M++){const E=n*r+M;if(N[E]>0&&(N[E-1]===0||N[E+1]===0||N[E-r]===0||N[E+r]===0)){const O=m(E*4),Z=c*.6;k[E*4+3]=Math.round(255*Math.min(1,Math.max(0,(O-Z)/(c-Z))))}}b.putImageData(S,0,0),x(p.toDataURL("image/png"))},d.onerror=()=>v(new Error("load")),d.src=l})}async function qt(l){return new Promise(c=>{const x=new Image;x.onload=()=>{const d=document.createElement("canvas");d.width=80,d.height=80;const j=d.getContext("2d");j.drawImage(x,0,0,80,80);const{data:g}=j.getImageData(0,0,80,80);let r=0,i=0,p=0;for(let f=0;f<g.length;f+=4){if(g[f+3]<80)continue;const o=(.299*g[f]+.587*g[f+1]+.114*g[f+2])/255;r+=o,i+=o*o,p++}if(!p){c($);return}const b=r/p,S=Math.sqrt(Math.max(0,i/p-b*b));let k=100,u=100;b<.35?k=Math.min(130,Math.round(.42/(b+.01)*100)):b>.78&&(k=Math.max(80,Math.round(.6/(b+.01)*100))),S<.1?u=118:S>.38&&(u=90),c({...$,brightness:k,contrast:u,saturation:108})},x.onerror=()=>c($),x.src=l})}function Ot({adj:l,setAdj:c,presetName:x,setPresetName:v,onUpload:d,onRemoveBg:j,processing:g,hasImage:r,bgTolerance:i,setBgTolerance:p,bgColor:b,setBgColor:S,activeTool:k,setActiveTool:u}){const f=(o,w,z,m,A=1)=>e.jsxs("div",{style:{marginBottom:9},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[e.jsx("label",{style:{fontSize:"0.65rem",fontWeight:"600",color:"#374151"},children:w}),e.jsxs("span",{style:{fontSize:"0.65rem",color:"#9CA3AF",fontWeight:"600"},children:[l[o],o==="hue"?"Â°":o==="blur"?"px":"%"]})]}),e.jsx("input",{type:"range",min:z,max:m,step:A,value:l[o],onChange:T=>{c({...l,[o]:Number(T.target.value)}),v("")},style:{width:"100%",accentColor:"#FF6835",cursor:"pointer",height:3}})]},o);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"10px 12px"},children:[e.jsxs("button",{onClick:d,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:6,padding:"8px",borderRadius:8,border:"1.5px dashed #FFD4C2",backgroundColor:"#FFF4F0",color:"#FF6835",cursor:"pointer",fontSize:"0.75rem",fontWeight:"700",marginBottom:8},children:[e.jsx(et,{size:13})," Cargar imagen"]}),e.jsx("button",{onClick:j,disabled:!r||g,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:6,padding:"8px",borderRadius:8,border:`1.5px solid ${r&&!g?"#818CF8":"#E5E7EB"}`,backgroundColor:r&&!g?"#EEF2FF":"#F9FAFB",color:r&&!g?"#4F46E5":"#9CA3AF",cursor:r&&!g?"pointer":"not-allowed",fontSize:"0.75rem",fontWeight:"700",marginBottom:6},children:g?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{size:13,style:{animation:"spin 0.8s linear infinite"}})," Procesando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{size:13})," Quitar fondo"]})}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[e.jsx("label",{style:{fontSize:"0.62rem",fontWeight:"600",color:"#6B7280"},children:"Tolerancia"}),e.jsx("span",{style:{fontSize:"0.62rem",color:"#9CA3AF",fontWeight:"600"},children:i})]}),e.jsx("input",{type:"range",min:5,max:120,step:1,value:i,onChange:o=>p(Number(o.target.value)),style:{width:"100%",accentColor:"#4F46E5",cursor:"pointer",height:3}})]}),e.jsxs("div",{style:{marginBottom:14},children:[e.jsx("label",{style:{fontSize:"0.62rem",fontWeight:"700",color:"#6B7280",display:"block",marginBottom:5},children:"Color de fondo"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[e.jsx("button",{onClick:()=>S(""),title:"Transparente",style:{width:22,height:22,borderRadius:4,border:`2px solid ${b===""?"#FF6835":"#E5E7EB"}`,backgroundImage:"repeating-conic-gradient(#ccc 0% 25%,#fff 0% 50%)",backgroundSize:"6px 6px",cursor:"pointer",flexShrink:0}}),e.jsxs("label",{style:{position:"relative",cursor:"pointer",width:22,height:22,flexShrink:0},children:[e.jsx("div",{style:{width:22,height:22,borderRadius:4,border:`2px solid ${b?"#FF6835":"#E5E7EB"}`,backgroundColor:b||"#fff"}}),e.jsx("input",{type:"color",value:b||"#ffffff",onChange:o=>S(o.target.value),style:{position:"absolute",inset:0,opacity:0,width:"100%",height:"100%",cursor:"pointer"}})]}),["#ffffff","#f5f5f5","#000000","#f0ede8"].map(o=>e.jsx("button",{onClick:()=>S(o),style:{width:18,height:18,borderRadius:3,border:`1.5px solid ${b===o?"#FF6835":"#D1D5DB"}`,backgroundColor:o,cursor:"pointer",flexShrink:0}},o))]})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("label",{style:$e,children:"Filtro"}),e.jsxs("select",{value:x,onChange:o=>{const w=o.target.value,z=Le.find(m=>m.name===w);z&&(c(z.values),v(w))},style:{width:"100%",padding:"7px 10px",borderRadius:7,border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",color:"#374151",fontSize:"0.72rem",fontWeight:"600",cursor:"pointer",outline:"none",appearance:"auto"},children:[e.jsx("option",{value:"",children:"â€” Seleccionar filtro â€”"}),Le.map(o=>e.jsx("option",{value:o.name,children:o.name},o.name))]})]}),e.jsx("p",{style:$e,children:"Ajustes"}),f("brightness","Brillo",0,200),f("contrast","Contraste",0,200),f("saturation","SaturaciÃ³n",0,200),f("hue","Tono",-180,180),f("sepia","Sepia",0,100),f("blur","Desenfoque",0,20),f("opacity","Opacidad",10,100),e.jsx("button",{onClick:()=>{c($),v("Original")},style:{width:"100%",padding:"6px",borderRadius:7,border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",color:"#6B7280",cursor:"pointer",fontSize:"0.72rem",fontWeight:"600",marginBottom:16},children:"â†º Restablecer ajustes"}),e.jsx("p",{style:$e,children:"Herramientas"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:5},children:Tt.map(({id:o,Icon:w,tip:z})=>{const m=k===o,A=o==="watermark";return e.jsx("button",{onClick:()=>u(o),title:z,style:{height:36,borderRadius:7,border:`1.5px solid ${m?A?"#10B981":"#FF6835":"#E5E7EB"}`,backgroundColor:m?A?"#10B981":"#FF6835":"#F9FAFB",color:m?"#fff":"#374151",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.1s"},children:e.jsx(w,{size:15})},o)})})]}),e.jsx("style",{children:"@keyframes spin{to{transform:rotate(360deg)}}"})]})}function Pt({slots:l,activeSlot:c,slotSize:x,onSlotClick:v}){return e.jsx("div",{style:{width:x,flexShrink:0,display:"flex",flexDirection:"column",backgroundColor:"#ADADAD",borderRight:"1px solid #989898"},children:l.map((d,j)=>{const g=Lt[j],r=j===c;return e.jsx("div",{onClick:()=>v(j),title:Se[j],style:{width:x,height:x,flexShrink:0,position:"relative",cursor:"pointer",boxSizing:"border-box",backgroundColor:"#C0C0C0",overflow:"hidden",outline:r?"3px solid #FF6835":"2px solid transparent",outlineOffset:"-2px",transition:"outline-color 0.1s"},children:d?e.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:"repeating-conic-gradient(#AAAAAA 0% 25%,transparent 0% 50%)",backgroundSize:"8px 8px"},children:e.jsx("img",{src:d.src,alt:"",draggable:!1,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain",filter:Ne(d.adj),transform:`rotate(${d.rotation}deg) scaleX(${d.flipH?-1:1}) scaleY(${d.flipV?-1:1})`}})}):e.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(g,{size:Math.round(x*.28),style:{color:"#777",opacity:.55}})})},j)})})}function Vt({imageSrc:l,adj:c,rotation:x,setRotation:v,flipH:d,setFlipH:j,flipV:g,setFlipV:r,zoom:i,onZoom:p,onLoad:b,imgDims:S,slots:k,activeSlot:u,onSlotClick:f,selectedTemplate:o,processing:w,bgColor:z,activeTool:m,setActiveTool:A,selectedId:T,setSelectedId:q,imagePos:H,setImagePos:W,textItems:N,setTextItems:n,fontFamily:M,setFontFamily:E,fontSize:O,setFontSize:Z,fontBold:se,setFontBold:we,fontItalic:te,setFontItalic:pe,fontUnderline:oe,setFontUnderline:L,textAlign:P,setTextAlign:Q,textColor:J,setTextColor:ne,onUndo:G,onClear:Ee,onDelete:ze,canUndo:ae,hasSelected:re}){const ue=h.useRef(null),ee=h.useRef(null),[Me,Be]=h.useState(80),[xe,fe]=h.useState(400),[le,ge]=h.useState(400),[V,ce]=h.useState(null),U=We.find(t=>t.id===o)??We[0];h.useEffect(()=>{const t=ue.current;if(!t)return;const y=()=>{const{width:I,height:s}=t.getBoundingClientRect(),a=Math.max(52,Math.floor(s/6));Be(a);const C=I-a-28,F=s-16,_=U.w/U.h;if(C/F>_){const X=F;ge(X),fe(Math.round(X*_))}else{const X=C;fe(X),ge(Math.round(X/_))}};y();const D=new ResizeObserver(y);return D.observe(t),()=>D.disconnect()},[U.w,U.h]);const Ae=t=>{m==="select"&&(t.preventDefault(),t.stopPropagation(),q("image"),ce({info:{kind:"image",ox:H.x,oy:H.y},startX:t.clientX,startY:t.clientY}))},ye=(t,y)=>{m==="select"&&(t.preventDefault(),t.stopPropagation(),q(y.id),ce({info:{kind:"text",id:y.id,ox:y.x,oy:y.y},startX:t.clientX,startY:t.clientY}))},me=t=>{if(!V||!ee.current)return;const y=ee.current.getBoundingClientRect(),D=t.clientX-V.startX,I=t.clientY-V.startY;if(V.info.kind==="image")W({x:V.info.ox+D,y:V.info.oy+I});else{const s=D/y.width*100,a=I/y.height*100;n(C=>C.map(F=>F.id===V.info.id?{...F,x:V.info.ox+s,y:V.info.oy+a}:F))}},de=()=>ce(null),Ie=t=>{if(t.target===ee.current){if(m==="watermark"){const y=ee.current.getBoundingClientRect(),D={id:"wm_"+Te(),content:"Â© MARCA DE AGUA",x:(t.clientX-y.left)/y.width*100,y:(t.clientY-y.top)/y.height*100,fontFamily:"Arial",fontSize:80,bold:!0,italic:!1,underline:!1,align:"center",color:"rgba(255,255,255,0.4)",rotation:-30,opacity:55};n(I=>[...I,D]),q(D.id),A("select");return}if(m==="text"){const y=ee.current.getBoundingClientRect(),D={id:Te(),content:"Texto",x:(t.clientX-y.left)/y.width*100,y:(t.clientY-y.top)/y.height*100,fontFamily:M,fontSize:O,bold:se,italic:te,underline:oe,align:P,color:J,rotation:0,opacity:100};n(I=>[...I,D]),q(D.id)}else q(null)}},Re=`rotate(${x}deg) scaleX(${d?-1:1}) scaleY(${g?-1:1})`,be=S?Ze(S.w,S.h):null,je={select:"default",crop:"crosshair",transform:"move",pan:"grab",text:"text",eyedrop:"crosshair",watermark:"copy"},Y=t=>({...R,backgroundColor:t?"#FFF4F0":"#fff",color:t?"#FF6835":"#374151",border:`1px solid ${t?"#FFD4C2":"#E5E7EB"}`});return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{height:44,backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",alignItems:"center",padding:"0 10px",gap:4,flexShrink:0,overflowX:"auto",overflowY:"hidden"},children:[e.jsx("button",{onClick:()=>p(Math.max(25,i-10)),style:R,children:e.jsx(Nt,{size:13})}),e.jsxs("span",{style:Oe,children:[i,"%"]}),e.jsx("button",{onClick:()=>p(Math.min(200,i+10)),style:R,children:e.jsx(Wt,{size:13})}),e.jsx("input",{type:"range",min:25,max:200,step:5,value:i,onChange:t=>p(Number(t.target.value)),style:{width:65,accentColor:"#FF6835",cursor:"pointer",flexShrink:0}}),e.jsx("button",{onClick:()=>p(100),style:{...R,fontSize:"0.62rem",fontWeight:"700",padding:"3px 6px",width:"auto"},children:"1:1"}),e.jsx("div",{style:K}),e.jsx("button",{onClick:()=>v((x-1+360)%360),style:R,children:e.jsx(Qe,{size:13})}),e.jsxs("span",{style:Oe,children:[x,"Â°"]}),e.jsx("button",{onClick:()=>v((x+1)%360),style:R,children:e.jsx(zt,{size:13})}),e.jsx("input",{type:"range",min:0,max:360,step:1,value:x,onChange:t=>{const y=Number(t.target.value);v(y>=360?0:y)},style:{width:65,accentColor:"#FF6835",cursor:"pointer",flexShrink:0}}),e.jsx("button",{onClick:()=>v(0),style:{...R,fontSize:"0.62rem",fontWeight:"700",padding:"3px 6px",width:"auto"},children:"0Â°"}),e.jsx("div",{style:K}),e.jsx("button",{onClick:()=>j(!d),title:"Flip H",style:{...R,backgroundColor:d?"#EFF6FF":"#fff",color:d?"#3B82F6":"#374151",border:`1px solid ${d?"#BFDBFE":"#E5E7EB"}`},children:e.jsx(yt,{size:14})}),e.jsx("button",{onClick:()=>r(!g),title:"Flip V",style:{...R,backgroundColor:g?"#EFF6FF":"#fff",color:g?"#3B82F6":"#374151",border:`1px solid ${g?"#BFDBFE":"#E5E7EB"}`},children:e.jsx(bt,{size:14})}),be&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:K}),e.jsx("span",{style:{fontSize:"0.68rem",fontWeight:"700",color:"#6B7280",whiteSpace:"nowrap",userSelect:"none"},children:be}),S&&e.jsxs("span",{style:{fontSize:"0.6rem",color:"#9CA3AF",whiteSpace:"nowrap",userSelect:"none"},children:[S.w,"Ã—",S.h]})]}),e.jsx("div",{style:K}),e.jsx("button",{onClick:()=>A(m==="text"?"select":"text"),style:Y(m==="text"),title:"Texto",children:e.jsx(Ue,{size:14})}),e.jsx("div",{style:K}),e.jsx("select",{value:M,onChange:t=>E(t.target.value),style:{height:28,padding:"0 5px",border:"1px solid #E5E7EB",borderRadius:6,fontSize:"0.7rem",backgroundColor:"#fff",cursor:"pointer",color:"#374151",outline:"none",flexShrink:0,fontFamily:M,maxWidth:100},children:Ht.map(t=>e.jsx("option",{value:t,style:{fontFamily:t},children:t},t))}),e.jsx("button",{onClick:()=>Z(Math.max(8,O-2)),style:{...R,width:22,height:26},children:"âˆ’"}),e.jsx("input",{type:"number",value:O,min:8,max:200,onChange:t=>Z(Math.max(8,Math.min(200,Number(t.target.value)))),style:{width:40,height:26,padding:"0 3px",border:"1px solid #E5E7EB",borderRadius:6,fontSize:"0.7rem",fontWeight:"700",textAlign:"center",color:"#374151",outline:"none",flexShrink:0}}),e.jsx("button",{onClick:()=>Z(Math.min(200,O+2)),style:{...R,width:22,height:26},children:"+"}),e.jsx("div",{style:K}),e.jsx("button",{onClick:()=>we(!se),style:Y(se),children:e.jsx(Pe,{size:13})}),e.jsx("button",{onClick:()=>pe(!te),style:Y(te),children:e.jsx(Ve,{size:13})}),e.jsx("button",{onClick:()=>L(!oe),style:Y(oe),children:e.jsx(It,{size:13})}),e.jsx("div",{style:K}),e.jsx("button",{onClick:()=>Q("left"),style:Y(P==="left"),children:e.jsx(at,{size:13})}),e.jsx("button",{onClick:()=>Q("center"),style:Y(P==="center"),children:e.jsx(it,{size:13})}),e.jsx("button",{onClick:()=>Q("right"),style:Y(P==="right"),children:e.jsx(ct,{size:13})}),e.jsx("div",{style:K}),e.jsxs("label",{style:{position:"relative",cursor:"pointer",flexShrink:0},children:[e.jsx("div",{style:{width:26,height:26,borderRadius:6,border:"1.5px solid #E5E7EB",backgroundColor:J,cursor:"pointer"}}),e.jsx("input",{type:"color",value:J,onChange:t=>ne(t.target.value),style:{position:"absolute",inset:0,opacity:0,width:"100%",height:"100%",cursor:"pointer"}})]}),e.jsx("div",{style:{flex:1}}),e.jsx("div",{style:K}),e.jsx("button",{onClick:G,disabled:!ae,title:"Deshacer (Ctrl+Z)",style:{...R,color:ae?"#374151":"#D1D5DB",border:`1px solid ${ae?"#E5E7EB":"#F3F4F6"}`},children:e.jsx($t,{size:14})}),e.jsx("button",{onClick:Ee,title:"Limpiar Ã¡rea",style:{...R,color:"#6B7280"},children:e.jsx(Je,{size:14})}),e.jsx("button",{onClick:ze,disabled:!re,title:"Eliminar seleccionado (Supr)",style:{...R,backgroundColor:re?"#FEF2F2":"#fff",color:re?"#EF4444":"#D1D5DB",border:`1px solid ${re?"#FECACA":"#F3F4F6"}`},children:e.jsx(De,{size:14})})]}),e.jsxs("div",{ref:ue,style:{flex:1,display:"flex",overflow:"hidden",backgroundColor:"#C2C2C2"},children:[e.jsx(Pt,{slots:k,activeSlot:u,slotSize:Me,onSlotClick:f}),e.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",position:"relative"},children:[e.jsxs("div",{ref:ee,onClick:Ie,onMouseMove:me,onMouseUp:de,onMouseLeave:de,style:{width:xe,height:le,flexShrink:0,position:"relative",backgroundColor:z||"#fff",backgroundImage:z?"none":"repeating-conic-gradient(#D1D5DB 0% 25%,transparent 0% 50%)",backgroundSize:"20px 20px",borderRadius:U.shape==="circle"?"50%":4,boxShadow:"0 4px 24px rgba(0,0,0,0.22)",overflow:"hidden",cursor:je[m]},children:[e.jsx("div",{style:{position:"absolute",bottom:5,right:7,fontSize:"0.5rem",fontWeight:"700",color:"rgba(0,0,0,0.2)",pointerEvents:"none",userSelect:"none",zIndex:2},children:U.desc}),l&&e.jsx("div",{onMouseDown:Ae,style:{position:"absolute",left:"50%",top:"50%",transform:`translate(calc(-50% + ${H.x}px),calc(-50% + ${H.y}px))`,cursor:m==="select"?"move":"default",zIndex:3,userSelect:"none",touchAction:"none"},children:e.jsx("div",{style:{transform:`scale(${i/100})`,transformOrigin:"center",transition:"transform 0.12s"},children:e.jsx("img",{src:l,alt:"editor",onLoad:t=>{const y=t.currentTarget;b(y.naturalWidth,y.naturalHeight)},draggable:!1,style:{maxWidth:xe,maxHeight:le,display:"block",transform:Re,filter:Ne(c),outline:T==="image"&&m==="select"?"2px solid #FF6835":"none",outlineOffset:"2px"}})})}),N.map(t=>{const y=T===t.id,D=Math.max(8,t.fontSize*le/800);return e.jsxs("div",{onMouseDown:I=>ye(I,t),style:{position:"absolute",left:`${t.x}%`,top:`${t.y}%`,transform:`translate(-50%,-50%) rotate(${t.rotation}deg)`,cursor:m==="select"?"move":m==="text"?"text":"default",userSelect:"none",zIndex:10,padding:4,borderRadius:3,outline:y?"1.5px dashed #FF6835":"none",touchAction:"none"},children:[e.jsx("span",{contentEditable:m==="text"&&y,suppressContentEditableWarning:!0,onBlur:I=>{var a;const s=((a=I.currentTarget.textContent)==null?void 0:a.trim())||"Texto";n(C=>C.map(F=>F.id===t.id?{...F,content:s}:F))},style:{fontFamily:t.fontFamily,fontSize:D,fontWeight:t.bold?"700":"400",fontStyle:t.italic?"italic":"normal",textDecoration:t.underline?"underline":"none",color:t.color,textAlign:t.align,whiteSpace:"nowrap",opacity:t.opacity/100,display:"block",outline:"none",textShadow:"0 1px 4px rgba(0,0,0,0.12)"},children:t.content}),y&&m==="select"&&e.jsx("button",{onClick:I=>{I.stopPropagation(),n(s=>s.filter(a=>a.id!==t.id)),q(null)},style:{position:"absolute",top:-10,right:-10,width:18,height:18,borderRadius:"50%",border:"none",backgroundColor:"#EF4444",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:20},children:e.jsx(De,{size:10})})]},t.id)}),w&&e.jsxs("div",{style:{position:"absolute",inset:0,backgroundColor:"rgba(79,70,229,0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:8,zIndex:30},children:[e.jsx(Xe,{size:28,color:"#4F46E5",style:{animation:"spin 0.8s linear infinite"}}),e.jsx("span",{style:{fontSize:"0.78rem",fontWeight:"700",color:"#4F46E5",backgroundColor:"rgba(255,255,255,0.9)",padding:"4px 12px",borderRadius:20},children:"Quitando fondo..."})]})]}),!l&&!w&&e.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none",gap:6},children:[e.jsx("div",{style:{fontSize:"3rem"},children:"ðŸ–¼ï¸"}),e.jsx("p",{style:{fontSize:"0.85rem",fontWeight:"700",color:"#fff",margin:0,textShadow:"0 1px 4px rgba(0,0,0,0.3)"},children:"Sin imagen"}),e.jsx("p",{style:{fontSize:"0.72rem",color:"rgba(255,255,255,0.8)",margin:0},children:"CargÃ¡ o arrastrÃ¡ aquÃ­"})]})]})]})]})}function Ut({imageSrc:l,adj:c,rotation:x,flipH:v,flipV:d,imgDims:j,onExport:g,selectedTemplate:r,setSelectedTemplate:i,textItems:p,setTextItems:b,selectedId:S}){const k=Object.entries(c).filter(([o,w])=>w!==$[o]).length,u=p.find(o=>o.id===S),f=o=>b(w=>w.map(z=>z.id===u.id?{...z,...o}:z));return e.jsxs("div",{children:[j&&e.jsxs(e.Fragment,{children:[e.jsx("p",{style:ve,children:"Dimensiones"}),e.jsxs("p",{style:{fontSize:"0.78rem",fontWeight:"700",color:"#111827",margin:"0 0 2px"},children:[j.w," Ã— ",j.h," px"]}),e.jsx("p",{style:{fontSize:"0.68rem",color:"#9CA3AF",margin:"0 0 10px"},children:Ze(j.w,j.h)})]}),e.jsx("p",{style:ve,children:"Estado actual"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:12},children:[x>0&&e.jsxs(Ce,{c:"#FF6835",children:["â†» ",x,"Â°"]}),v&&e.jsx(Ce,{c:"#3B82F6",children:"â†” H"}),d&&e.jsx(Ce,{c:"#3B82F6",children:"â†• V"}),k>0&&e.jsxs(Ce,{c:"#10B981",children:["âœ“ ",k," aj."]}),!x&&!v&&!d&&k===0&&e.jsx("span",{style:{fontSize:"0.7rem",color:"#9CA3AF"},children:"Sin modificaciones"})]}),u&&e.jsxs("div",{style:{marginBottom:16,padding:10,borderRadius:8,border:"1px solid #E5E7EB",backgroundColor:"#FAFAFA"},children:[e.jsx("p",{style:{...ve,marginBottom:6},children:"Texto seleccionado"}),e.jsx("textarea",{value:u.content,rows:2,onChange:o=>f({content:o.target.value}),style:{width:"100%",padding:"6px 8px",border:"1px solid #E5E7EB",borderRadius:6,fontSize:"0.72rem",resize:"vertical",outline:"none",boxSizing:"border-box",marginBottom:8}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[e.jsx("label",{style:{fontSize:"0.62rem",fontWeight:"600",color:"#6B7280"},children:"Opacidad"}),e.jsxs("span",{style:{fontSize:"0.62rem",color:"#9CA3AF"},children:[u.opacity,"%"]})]}),e.jsx("input",{type:"range",min:10,max:100,value:u.opacity,onChange:o=>f({opacity:Number(o.target.value)}),style:{width:"100%",accentColor:"#FF6835",height:3}})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[e.jsx("label",{style:{fontSize:"0.62rem",fontWeight:"600",color:"#6B7280"},children:"RotaciÃ³n"}),e.jsxs("span",{style:{fontSize:"0.62rem",color:"#9CA3AF"},children:[u.rotation,"Â°"]})]}),e.jsx("input",{type:"range",min:-180,max:180,value:u.rotation,onChange:o=>f({rotation:Number(o.target.value)}),style:{width:"100%",accentColor:"#FF6835",height:3}})]})]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[e.jsx("label",{style:{fontSize:"0.62rem",fontWeight:"600",color:"#6B7280"},children:"TamaÃ±o"}),e.jsxs("span",{style:{fontSize:"0.62rem",color:"#9CA3AF"},children:[u.fontSize,"px"]})]}),e.jsx("input",{type:"range",min:8,max:200,value:u.fontSize,onChange:o=>f({fontSize:Number(o.target.value)}),style:{width:"100%",accentColor:"#FF6835",height:3}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8},children:[e.jsx("label",{style:{fontSize:"0.62rem",fontWeight:"600",color:"#6B7280"},children:"Color"}),e.jsxs("label",{style:{position:"relative",cursor:"pointer"},children:[e.jsx("div",{style:{width:22,height:22,borderRadius:4,border:"1px solid #E5E7EB",backgroundColor:u.color}}),e.jsx("input",{type:"color",value:u.color.startsWith("rgba")?"#ffffff":u.color,onChange:o=>f({color:o.target.value}),style:{position:"absolute",inset:0,opacity:0,width:"100%",height:"100%",cursor:"pointer"}})]}),e.jsxs("div",{style:{display:"flex",gap:4,marginLeft:"auto"},children:[e.jsx("button",{onClick:()=>f({bold:!u.bold}),style:{...R,width:24,height:24,backgroundColor:u.bold?"#FFF4F0":"#fff",color:u.bold?"#FF6835":"#374151",border:`1px solid ${u.bold?"#FFD4C2":"#E5E7EB"}`},children:e.jsx(Pe,{size:11})}),e.jsx("button",{onClick:()=>f({italic:!u.italic}),style:{...R,width:24,height:24,backgroundColor:u.italic?"#FFF4F0":"#fff",color:u.italic?"#FF6835":"#374151",border:`1px solid ${u.italic?"#FFD4C2":"#E5E7EB"}`},children:e.jsx(Ve,{size:11})})]})]})]}),e.jsxs("button",{onClick:()=>l&&g(),disabled:!l,style:{width:"100%",padding:"9px",borderRadius:8,border:"none",backgroundColor:l?"#FF6835":"#E5E7EB",color:l?"#fff":"#9CA3AF",cursor:l?"pointer":"not-allowed",fontSize:"0.78rem",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",gap:5,marginBottom:16},children:[e.jsx(_e,{size:13})," Exportar"]}),e.jsx("p",{style:ve,children:"Templates"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:We.map(o=>{const w=r===o.id,z=o.w/o.h,m=Math.min(24,Math.round(32/z)),A=Math.round(m*z);return e.jsxs("button",{onClick:()=>i(o.id),style:{display:"flex",alignItems:"center",gap:8,padding:"6px 8px",borderRadius:7,border:`1.5px solid ${w?"#FF6835":"#E5E7EB"}`,backgroundColor:w?"#FFF4F0":"#fff",cursor:"pointer"},children:[e.jsx("div",{style:{width:36,height:26,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{width:A,height:m,border:`1.5px solid ${w?"#FF6835":"#9CA3AF"}`,borderRadius:o.shape==="circle"?"50%":2,backgroundColor:w?"#FECDD3":"#F3F4F6"}})}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("div",{style:{fontSize:"0.72rem",fontWeight:"700",color:w?"#FF6835":"#111827"},children:o.name}),e.jsx("div",{style:{fontSize:"0.6rem",color:"#9CA3AF"},children:o.desc})]})]},o.id)})})]})}function Xt({slots:l,onClose:c,onExportSelected:x}){const v=l.map((i,p)=>({s:i,i:p})).filter(({s:i})=>i!==null),[d,j]=h.useState(l.map((i,p)=>p<=1&&i!==null)),g=i=>j(p=>p.map((b,S)=>S===i?!b:b)),r=d.map((i,p)=>i?p:-1).filter(i=>i>=0);return e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9e3},children:e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:14,padding:24,width:340,boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:"0.95rem",fontWeight:"800"},children:"Â¿QuÃ© exportar?"}),e.jsx("button",{onClick:c,style:{background:"none",border:"none",cursor:"pointer",color:"#9CA3AF"},children:e.jsx(De,{size:16})})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:20},children:v.map(({s:i,i:p})=>i?e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 10px",borderRadius:8,border:`1.5px solid ${d[p]?"#FF6835":"#E5E7EB"}`,backgroundColor:d[p]?"#FFF4F0":"#fff",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:d[p],onChange:()=>g(p),style:{display:"none"}}),d[p]?e.jsx(Ke,{size:15,color:"#FF6835"}):e.jsx(Bt,{size:15,color:"#9CA3AF"}),e.jsx("img",{src:i.src,alt:"",style:{width:36,height:36,objectFit:"contain",borderRadius:4,border:"1px solid #F3F4F6"}}),e.jsx("span",{style:{fontSize:"0.78rem",fontWeight:"700",color:"#374151"},children:Se[p]})]},p):null)}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{onClick:c,style:{flex:1,padding:"9px",borderRadius:8,border:"1px solid #E5E7EB",backgroundColor:"#fff",color:"#374151",cursor:"pointer",fontSize:"0.78rem",fontWeight:"600"},children:"Cancelar"}),e.jsxs("button",{onClick:()=>{x(r),c()},disabled:r.length===0,style:{flex:2,padding:"9px",borderRadius:8,border:"none",backgroundColor:r.length>0?"#FF6835":"#E5E7EB",color:r.length>0?"#fff":"#9CA3AF",cursor:r.length>0?"pointer":"not-allowed",fontSize:"0.78rem",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",gap:5},children:[e.jsx(_e,{size:13})," Exportar ",r.length>0?`(${r.length})`:""]})]})]})})}const Ce=({children:l,c})=>e.jsx("span",{style:{padding:"2px 7px",borderRadius:4,backgroundColor:`${c}18`,color:c,fontSize:"0.65rem",fontWeight:"700"},children:l}),$e={fontSize:"0.6rem",fontWeight:"800",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.08em",margin:"0 0 5px"},ve={fontSize:"0.6rem",fontWeight:"800",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.06em",margin:"0 0 5px"},R={width:28,height:28,borderRadius:6,border:"1px solid #E5E7EB",backgroundColor:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#374151",flexShrink:0},Oe={fontSize:"0.72rem",fontWeight:"700",color:"#374151",minWidth:34,textAlign:"center",userSelect:"none",flexShrink:0},K={width:1,height:20,backgroundColor:"#E5E7EB",margin:"0 2px",flexShrink:0};function hn({onNavigate:l}){const[c,x]=h.useState(null),[v,d]=h.useState("imagen"),[j,g]=h.useState($),[r,i]=h.useState("Original"),[p,b]=h.useState(0),[S,k]=h.useState(!1),[u,f]=h.useState(!1),[o,w]=h.useState(100),[z,m]=h.useState(null),[A,T]=h.useState(Array(6).fill(null)),[q,H]=h.useState(-1),[W,N]=h.useState(!1),[n,M]=h.useState(58),[E,O]=h.useState(""),[Z,se]=h.useState("square"),[we,te]=h.useState(!1),[pe,oe]=h.useState("select"),[L,P]=h.useState(null),[Q,J]=h.useState({x:0,y:0}),[ne,G]=h.useState([]),[Ee,ze]=h.useState("Arial"),[ae,re]=h.useState(72),[ue,ee]=h.useState(!1),[Me,Be]=h.useState(!1),[xe,fe]=h.useState(!1),[le,ge]=h.useState("center"),[V,ce]=h.useState("#ffffff"),U=h.useRef([]),[Ae,ye]=h.useState(!1),me=h.useRef(null),de=s=>{const a=new FileReader;a.onload=async C=>{var X;const F=(X=C.target)==null?void 0:X.result;x(F),d(s.name.replace(/\.[^.]+$/,"")),g($),i("Original"),b(0),k(!1),f(!1),w(100),J({x:0,y:0}),G([]);const _=Array(6).fill(null);_[0]={src:F,adj:$,rotation:0,flipH:!1,flipV:!1,label:"Original"},T(_),H(0),N(!0),setTimeout(async()=>{try{const ie=await qe(F,n),Fe=await qt(ie);T(he=>{const He=[...he];return He[1]={src:ie,adj:Fe,rotation:0,flipH:!1,flipV:!1,label:"Auto"},He}),x(ie),g(Fe),i(""),H(1)}catch{}finally{N(!1)}},60)},a.readAsDataURL(s)},Ie=h.useCallback(s=>{s.preventDefault();const a=s.dataTransfer.files[0];a!=null&&a.type.startsWith("image/")&&de(a)},[n]),Re=()=>{!c||W||(N(!0),setTimeout(async()=>{try{x(await qe(c,n))}catch{}finally{N(!1)}},60))},be=s=>{const a=A[s];if(a)x(a.src),g(a.adj),i(""),b(a.rotation),k(a.flipH),f(a.flipV),H(s);else{if(!c)return;T(C=>{const F=[...C];return F[s]={src:c,adj:j,rotation:p,flipH:S,flipV:u,label:Se[s]},F}),H(s)}},je=h.useCallback((s,a)=>{U.current=[...U.current.slice(-9),{textItems:s,imagePos:a}],ye(!0)},[]),Y=()=>{const s=U.current.pop();s&&(G(s.textItems),J(s.imagePos),P(null),ye(U.current.length>0))},t=()=>{je(ne,Q),G([]),J({x:0,y:0}),P(null)},y=()=>{L&&(je(ne,Q),L==="image"||G(s=>s.filter(a=>a.id!==L)),P(null))};h.useEffect(()=>{const s=a=>{const C=a.target.tagName;C==="INPUT"||C==="TEXTAREA"||a.target.isContentEditable||((a.key==="Delete"||a.key==="Backspace")&&L&&L!=="image"&&(G(F=>F.filter(_=>_.id!==L)),P(null)),(a.ctrlKey||a.metaKey)&&a.key==="z"&&(a.preventDefault(),Y()))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[L,ne,Q]);const D=(s,a)=>{const C=new Image;C.onload=()=>{const F=document.createElement("canvas");F.width=C.naturalWidth,F.height=C.naturalHeight;const _=F.getContext("2d");_.filter=Ne(s.adj);const X=F.width/2,ie=F.height/2;_.translate(X,ie),_.rotate(s.rotation*Math.PI/180),_.scale(s.flipH?-1:1,s.flipV?-1:1),_.drawImage(C,-X,-ie);const Fe=F.toDataURL("image/png"),he=document.createElement("a");he.href=Fe,he.download=`${a}.png`,he.click()},C.src=s.src},I=s=>s.forEach(a=>{const C=A[a];C&&D(C,`${v}_${Se[a].toLowerCase()}`)});return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:me,type:"file",accept:"image/*",style:{display:"none"},onChange:s=>{var C;const a=(C=s.target.files)==null?void 0:C[0];a&&de(a)}}),we&&e.jsx(Xt,{slots:A,onClose:()=>te(!1),onExportSelected:I}),e.jsx(Ge,{toolId:"editor-imagenes",onNavigate:l,leftPanel:e.jsx(Ot,{adj:j,setAdj:g,presetName:r,setPresetName:i,onUpload:()=>{var s;return(s=me.current)==null?void 0:s.click()},onRemoveBg:Re,processing:W,hasImage:!!c,bgTolerance:n,setBgTolerance:M,bgColor:E,setBgColor:O,activeTool:pe,setActiveTool:oe}),canvas:e.jsx("div",{style:{height:"100%"},onDragOver:s=>s.preventDefault(),onDrop:Ie,children:e.jsx(Vt,{imageSrc:c,adj:j,rotation:p,setRotation:b,flipH:S,setFlipH:k,flipV:u,setFlipV:f,zoom:o,onZoom:w,onLoad:(s,a)=>m({w:s,h:a}),imgDims:z,slots:A,activeSlot:q,onSlotClick:be,selectedTemplate:Z,processing:W,bgColor:E,activeTool:pe,setActiveTool:oe,selectedId:L,setSelectedId:P,imagePos:Q,setImagePos:J,textItems:ne,setTextItems:G,fontFamily:Ee,setFontFamily:ze,fontSize:ae,setFontSize:re,fontBold:ue,setFontBold:ee,fontItalic:Me,setFontItalic:Be,fontUnderline:xe,setFontUnderline:fe,textAlign:le,setTextAlign:ge,textColor:V,setTextColor:ce,onUndo:Y,onClear:t,onDelete:y,canUndo:Ae,hasSelected:!!L})}),properties:e.jsx(Ut,{imageSrc:c,adj:j,rotation:p,flipH:S,flipV:u,imgDims:z,onExport:()=>te(!0),selectedTemplate:Z,setSelectedTemplate:se,textItems:ne,setTextItems:G,selectedId:L}),actions:c?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontSize:"0.68rem",color:"#71717A"},children:v}),e.jsxs("button",{onClick:()=>te(!0),style:{display:"flex",alignItems:"center",gap:4,padding:"4px 10px",borderRadius:5,border:"none",backgroundColor:"#FF6835",color:"#fff",cursor:"pointer",fontSize:"0.72rem",fontWeight:"700"},children:[e.jsx(_e,{size:12})," Exportar"]})]}):void 0})]})}export{hn as EditorImagenesWorkspace};
