import{k as T,h as v,r as h,j as e,f as C,P as S,Q as W,T as F,R as D}from"./index-C7B7W1lQ.js";import{O as I}from"./OrangeHeader-CoTBbwWn.js";import{M as k}from"./map-pin-QypTHBjh.js";import{L as N}from"./loader-circle-FhFeU9ES.js";import{G as B}from"./globe-BmYgUn7P.js";import{B as _}from"./bell-CFqS3i5v.js";import{N as z}from"./navigation-266tBcFe.js";import{C as L}from"./circle-x-Cl1JMT7N.js";import{C as A}from"./circle-check-D2QS8Bff.js";import{C as $}from"./copy-K5f6CEkY.js";import"./zap-DaP38y9l.js";import"./lightbulb-QoB3Dxu8.js";const P=`${T}/tracking`,O="oddy",V={"Content-Type":"application/json",Authorization:`Bearer ${v}`,apikey:v,"x-tenant-id":O};async function H(i){const t=await(await fetch(`${P}/${i}`,{headers:V})).json();if(t.error)throw new Error(t.error);return t}const c="#FF6835",b={creado:{color:"#6B7280",bg:"#F3F4F6",icon:S},despachado:{color:"#2563EB",bg:"#EFF6FF",icon:F},en_transito:{color:"#7C3AED",bg:"#F5F3FF",icon:z},en_deposito:{color:"#D97706",bg:"#FFFBEB",icon:k},en_reparto:{color:c,bg:"#FFF4EC",icon:F},entregado:{color:"#059669",bg:"#ECFDF5",icon:A},fallido:{color:"#DC2626",bg:"#FEF2F2",icon:L}};function Q({data:i,onCopy:p}){const t=b[i.estadoTipo],u=t.icon,x=["creado","despachado","en_transito","en_deposito","en_reparto","entregado"],g=x.indexOf(i.estadoTipo),f={creado:"Creado",despachado:"Despachado",en_transito:"En trÃ¡nsito",en_deposito:"En depÃ³sito",en_reparto:"En reparto",entregado:"Entregado"};return e.jsxs("div",{style:{maxWidth:"640px",margin:"0 auto"},children:[e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",border:"1px solid #E5E7EB",overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.06)",marginBottom:"16px"},children:[e.jsx("div",{style:{backgroundColor:t.bg,padding:"24px",borderBottom:`3px solid ${t.color}`},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[e.jsx("div",{style:{width:"52px",height:"52px",borderRadius:"50%",backgroundColor:t.color,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(u,{size:24,color:"#fff"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"20px",fontWeight:800,color:t.color,marginBottom:"3px"},children:i.estado}),e.jsx("div",{style:{fontSize:"13px",color:"#6B7280"},children:i.estadoTipo==="entregado"?"âœ“ EnvÃ­o completado exitosamente":i.estadoTipo==="en_reparto"?"ðŸšš En camino a tu domicilio hoy":`Fecha estimada de entrega: ${i.fechaEstimada}`})]})]})}),i.estadoTipo!=="fallido"&&e.jsx("div",{style:{padding:"20px 24px",borderBottom:"1px solid #F3F4F6"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0"},children:x.map((a,s)=>{const r=s<=g,l=s===g;return e.jsxs(D.Fragment,{children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:s===0||s===x.length-1?0:1},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:r?t.color:"#E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",border:l?`3px solid ${t.color}`:"none",boxShadow:l?`0 0 0 3px ${t.color}30`:"none",transition:"all 0.2s",flexShrink:0},children:r&&!l?e.jsx(A,{size:14,color:"#fff"}):e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:r?"#fff":"#D1D5DB"}})}),e.jsx("div",{style:{fontSize:"9px",fontWeight:r?700:400,color:r?t.color:"#9CA3AF",marginTop:"4px",textAlign:"center",whiteSpace:"nowrap"},children:f[a]})]}),s<x.length-1&&e.jsx("div",{style:{flex:1,height:"3px",backgroundColor:s<g?t.color:"#E5E7EB",transition:"background 0.3s",marginBottom:"18px",minWidth:"20px"}})]},a)})})}),e.jsx("div",{style:{padding:"20px 24px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"14px",borderBottom:"1px solid #F3F4F6"},children:[["ðŸ“¦ NÃºmero",i.numero],["ðŸšš Carrier",i.carrier],["ðŸ“ Origen",i.origen],["ðŸ  Destino",i.destino],["ðŸ‘¤ Destinatario",i.destinatario],["âš– Peso",i.peso]].map(([a,s])=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.06em",marginBottom:"3px"},children:a}),e.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#111"},children:s})]},a))}),e.jsxs("div",{style:{padding:"20px 24px"},children:[e.jsx("div",{style:{fontSize:"12px",fontWeight:700,color:"#374151",textTransform:"uppercase",letterSpacing:"0.06em",marginBottom:"14px"},children:"Historial"}),e.jsx("div",{style:{position:"relative"},children:i.eventos.map((a,s)=>{const r=b[a.tipo]||b.creado,l=s===0,j=r.icon;return e.jsxs("div",{style:{display:"flex",gap:"14px",paddingBottom:"16px",position:"relative"},children:[s<i.eventos.length-1&&e.jsx("div",{style:{position:"absolute",left:"14px",top:"28px",bottom:0,width:"2px",backgroundColor:"#F3F4F6"}}),e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:l?r.color:"#F3F4F6",border:`2px solid ${l?r.color:"#E5E7EB"}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,zIndex:1},children:e.jsx(j,{size:12,color:l?"#fff":"#9CA3AF"})}),e.jsxs("div",{style:{flex:1,paddingTop:"4px"},children:[e.jsx("div",{style:{fontSize:"13px",fontWeight:l?700:500,color:l?"#111":"#374151"},children:a.descripcion}),e.jsxs("div",{style:{fontSize:"11px",color:"#9CA3AF",marginTop:"2px"},children:[a.ubicacion," Â· ",a.fecha,", ",a.hora]})]})]},s)})})]})]}),e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"16px 20px",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(B,{size:18,color:c,style:{flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"2px"},children:"Link de tracking pÃºblico para el destinatario"}),e.jsxs("div",{style:{fontSize:"12px",color:"#2563EB",fontFamily:"monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["https://tutienda.com/tracking/",i.numero]})]}),e.jsxs("button",{onClick:p,style:{display:"flex",alignItems:"center",gap:"6px",padding:"7px 14px",border:`1.5px solid ${c}`,borderRadius:"8px",backgroundColor:"transparent",color:c,fontSize:"12px",fontWeight:700,cursor:"pointer",flexShrink:0},children:[e.jsx($,{size:13})," Copiar link"]})]})]})}const G=["ENV-15000-001","AND789012","ENV-15001-001","CA123456789AR"];function re({onNavigate:i}){const[p,t]=h.useState(""),[u,x]=h.useState(null),[g,f]=h.useState(!1),[a,s]=h.useState(!1),[r,l]=h.useState(!1),[j,E]=h.useState(null),y=async o=>{const m=o.trim();if(m){l(!0),E(null),f(!1);try{const n=await H(m),R={numero:n.numero||n.codigo,trackingExterno:n.tracking_externo||"",carrier:n.carrier||"",estado:n.estado||"",estadoTipo:n.estado_tipo||"creado",origen:n.origen||"",destino:n.destino||"",destinatario:n.destinatario||"",peso:n.peso||"",fechaEstimada:n.fecha_estimada||"",eventos:(n.eventos||[]).map(d=>({fecha:d.fecha?new Date(d.fecha).toLocaleDateString("es-AR",{day:"numeric",month:"short"}):"",hora:d.hora||(d.fecha?new Date(d.fecha).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"}):""),tipo:d.tipo||"info",descripcion:d.descripcion,ubicacion:d.ubicacion||d.lugar||""}))};x(R),f(!1)}catch(n){x(null),f(!0),E(n instanceof Error?n.message:"Error buscando envÃ­o"),console.error("Error buscando tracking:",n)}finally{l(!1)}}},w=()=>{s(!0),setTimeout(()=>s(!1),2e3)};return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx(I,{icon:k,title:"Tracking PÃºblico",subtitle:"Seguimiento de envÃ­os para destinatarios Â· PÃ¡gina pÃºblica de consulta",actions:[{label:"â† LogÃ­stica",onClick:()=>i("logistica")},{label:"ðŸŒ Ver pÃ¡gina pÃºblica",primary:!0}]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",backgroundColor:"#F8F9FA",padding:"28px 20px"},children:[e.jsx("div",{style:{maxWidth:"640px",margin:"0 auto 24px"},children:e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",border:"1px solid #E5E7EB",padding:"24px",boxShadow:"0 2px 12px rgba(0,0,0,0.06)"},children:[e.jsx("h2",{style:{margin:"0 0 6px",fontSize:"18px",fontWeight:800,color:"#111"},children:"Â¿DÃ³nde estÃ¡ mi paquete?"}),e.jsx("p",{style:{margin:"0 0 18px",fontSize:"13px",color:"#6B7280"},children:"IngresÃ¡ el nÃºmero de envÃ­o o cÃ³digo de seguimiento del carrier"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(C,{size:16,color:"#9CA3AF",style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)"}}),e.jsx("input",{value:p,onChange:o=>t(o.target.value),onKeyDown:o=>o.key==="Enter"&&y(p),placeholder:"Ej: ENV-15000-001 o CA123456789AR",style:{width:"100%",paddingLeft:"44px",paddingRight:"14px",paddingTop:"12px",paddingBottom:"12px",border:"1.5px solid #E5E7EB",borderRadius:"10px",fontSize:"14px",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("button",{onClick:()=>y(p),disabled:r,style:{padding:"12px 22px",border:"none",borderRadius:"10px",backgroundColor:r?"#9CA3AF":c,color:"#fff",fontSize:"14px",fontWeight:700,cursor:r?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[r?e.jsx(N,{size:15,style:{animation:"spin 1s linear infinite"}}):e.jsx(C,{size:15})," ",r?"Buscando...":"Buscar"]})]}),e.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"6px",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"11px",color:"#9CA3AF"},children:"Ejemplos:"}),G.map(o=>e.jsx("button",{onClick:()=>{t(o),y(o)},style:{fontSize:"11px",fontWeight:600,color:"#2563EB",backgroundColor:"#EFF6FF",padding:"3px 8px",borderRadius:"6px",border:"none",cursor:"pointer",fontFamily:"monospace"},children:o},o))]})]})}),u&&!r&&e.jsx(Q,{data:u,onCopy:w}),g&&!r&&e.jsxs("div",{style:{maxWidth:"480px",margin:"0 auto",textAlign:"center",padding:"40px 24px"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#FEE2E2",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(S,{size:28,color:"#DC2626"})}),e.jsx("h3",{style:{margin:"0 0 8px",fontSize:"16px",fontWeight:800,color:"#111"},children:"EnvÃ­o no encontrado"}),e.jsxs("p",{style:{margin:"0 0 20px",fontSize:"13px",color:"#6B7280",lineHeight:"1.6"},children:["No encontramos un envÃ­o con el nÃºmero ",e.jsxs("strong",{children:['"',p,'"']}),". VerificÃ¡ el nÃºmero e intentÃ¡ de nuevo."]}),e.jsx("button",{onClick:()=>{t(""),f(!1)},style:{padding:"10px 24px",border:`1.5px solid ${c}`,borderRadius:"8px",backgroundColor:"transparent",color:c,fontSize:"13px",fontWeight:700,cursor:"pointer"},children:"Buscar otro"})]}),!u&&!g&&!r&&e.jsxs("div",{style:{maxWidth:"640px",margin:"0 auto"},children:[e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"20px",marginBottom:"16px"},children:[e.jsx("h3",{style:{margin:"0 0 14px",fontSize:"13px",fontWeight:800,color:"#374151",textTransform:"uppercase",letterSpacing:"0.06em"},children:"CÃ³mo funciona el tracking pÃºblico"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[{icon:B,title:"PÃ¡gina pÃºblica",desc:"Los destinatarios pueden ver el estado sin loguearse"},{icon:_,title:"Notificaciones",desc:"Email y WhatsApp automÃ¡ticos en cada cambio de estado"},{icon:W,title:"QR de seguimiento",desc:"QR en cada paquete para escaneo inmediato"},{icon:z,title:"Tiempo real",desc:"El estado se actualiza automÃ¡ticamente con el carrier"}].map(o=>{const m=o.icon;return e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"34px",height:"34px",borderRadius:"10px",backgroundColor:"#FFF4EC",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(m,{size:16,color:c})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",fontWeight:700,color:"#111"},children:o.title}),e.jsx("div",{style:{fontSize:"11px",color:"#6B7280",marginTop:"2px",lineHeight:"1.4"},children:o.desc})]})]},o.title)})})]}),e.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 14px",fontSize:"13px",fontWeight:800,color:"#374151",textTransform:"uppercase",letterSpacing:"0.06em"},children:"Notificaciones automÃ¡ticas al destinatario"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{estado:"ðŸ“¦ Despachado",activo:!0,canales:"Email + WhatsApp"},{estado:"ðŸšš En reparto",activo:!0,canales:"WhatsApp"},{estado:"âœ“ Entregado",activo:!0,canales:"Email + WhatsApp"},{estado:"âš  Intento fallido",activo:!0,canales:"Email + WhatsApp + SMS"}].map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 14px",backgroundColor:"#F9FAFB",borderRadius:"8px"},children:[e.jsx("span",{style:{fontSize:"13px",flex:1},children:o.estado}),e.jsx("span",{style:{fontSize:"11px",color:"#6B7280"},children:o.canales}),e.jsx("div",{style:{width:"32px",height:"18px",borderRadius:"9px",backgroundColor:o.activo?c:"#E5E7EB",display:"flex",alignItems:"center",padding:"0 2px",justifyContent:o.activo?"flex-end":"flex-start"},children:e.jsx("div",{style:{width:"14px",height:"14px",borderRadius:"50%",backgroundColor:"#fff"}})})]},o.estado))})]})]}),a&&e.jsx("div",{style:{position:"fixed",bottom:"20px",right:"20px",backgroundColor:"#111",color:"#fff",padding:"10px 18px",borderRadius:"10px",fontSize:"13px",fontWeight:600,zIndex:999},children:"âœ“ Link copiado al portapapeles"})]})]})}export{re as TrackingPublicoView};
