import{r as c,t as m,j as e,S as T,T as ge,g as N,R as Re,P as Te,f as Ie}from"./index-CzcvZDmw.js";import{O as We}from"./OrangeHeader-nLm5nHcH.js";import{p as $e,a as Ne}from"./info-tCLo8W3J.js";import{g as Le}from"./personasApi-DFwchuwT.js";import{g as Oe}from"./organizacionesApi-B_Ij0WDQ.js";import{g as Ue}from"./metodosPagoApi-Bywx3w-L.js";import{g as Ye}from"./metodosEnvioApi-iW6EAm8Z.js";import{C as xe}from"./clock-CTimm46U.js";import{D as Me}from"./dollar-sign-DpLp6WVw.js";import{R as Ge}from"./rotate-ccw-Ch4RnLo5.js";import{C as He}from"./circle-x-B-BFHtGj.js";import{C as Xe}from"./chevron-right-D_3Ffm3a.js";import{R as ue}from"./refresh-cw-DjKtYfWn.js";import{U as ie}from"./user-B-KNPo3Y.js";import{B as Je}from"./building-2-DgOA9sBn.js";import{E as Ke}from"./eye-Dfs6stPr.js";import{X as se}from"./x-BnxWrq_V.js";import{C as qe}from"./credit-card-BpfUYB1b.js";import{M as Ve}from"./map-pin-bqNz1VOT.js";import{F as Qe}from"./file-text-AwnvgzQt.js";import{P as Ze}from"./plus-4d6aYh60.js";import{T as eo}from"./trash-2-C9nG65gh.js";import{S as oo}from"./save-BfWskPbG.js";import"./ConnectionStatusIcon-C3hf7mFy.js";import"./index-yKjPlrCh.js";import"./zap-AI_yIvWG.js";import"./lightbulb-BHMGz6eT.js";const L=`https://${$e}.supabase.co/functions/v1/api/pedidos`,O={"Content-Type":"application/json",Authorization:`Bearer ${Ne}`};async function to(s){try{return await(await fetch(`${L}${s}`,{headers:O})).json()}catch(n){return console.error(`Pedidos API GET ${s}:`,n),{ok:!1,error:String(n)}}}async function ro(s,n){try{return await(await fetch(`${L}${s}`,{method:"POST",headers:O,body:n?JSON.stringify(n):void 0})).json()}catch(l){return console.error(`Pedidos API POST ${s}:`,l),{ok:!1,error:String(l)}}}async function he(s,n){try{return await(await fetch(`${L}${s}`,{method:"PUT",headers:O,body:n?JSON.stringify(n):void 0})).json()}catch(l){return console.error(`Pedidos API PUT ${s}:`,l),{ok:!1,error:String(l)}}}async function no(s){const n=new URLSearchParams;s!=null&&s.estado&&n.set("estado",s.estado),s!=null&&s.estado_pago&&n.set("estado_pago",s.estado_pago),s!=null&&s.search&&n.set("search",s.search);const l=await to(n.toString()?`?${n}`:"");return!l.ok||!l.data?[]:l.data}async function io(s){const n=await ro("",s);return!n.ok||!n.data?null:n.data}async function so(s,n){const l=await he(`/${s}/estado`,{nuevo_estado:n});return!l.ok||!l.data?null:l.data}async function lo(s,n){const l=await he(`/${s}/estado-pago`,{estado_pago:n});return!l.ok||!l.data?null:l.data}const f="#FF6835",b={pendiente:{label:"Pendiente",color:"#D97706",bg:"#FEF3C7",icon:xe},confirmado:{label:"Confirmado",color:"#2563EB",bg:"#EFF6FF",icon:N},en_preparacion:{label:"En preparación",color:"#7C3AED",bg:"#F5F3FF",icon:Te},enviado:{label:"Enviado",color:"#0891B2",bg:"#ECFEFF",icon:ge},entregado:{label:"Entregado",color:"#059669",bg:"#D1FAE5",icon:N},cancelado:{label:"Cancelado",color:"#DC2626",bg:"#FEE2E2",icon:He},devuelto:{label:"Devuelto",color:"#6B7280",bg:"#F3F4F6",icon:Ge}},y={pendiente:{label:"Pago pendiente",color:"#D97706",bg:"#FEF3C7"},pagado:{label:"Pagado",color:"#059669",bg:"#D1FAE5"},parcial:{label:"Parcial",color:"#7C3AED",bg:"#F5F3FF"},fallido:{label:"Fallido",color:"#DC2626",bg:"#FEE2E2"},reembolsado:{label:"Reembolsado",color:"#6B7280",bg:"#F3F4F6"}},le={pendiente:["confirmado","cancelado"],confirmado:["en_preparacion","cancelado"],en_preparacion:["enviado","cancelado"],enviado:["entregado","cancelado"],entregado:["devuelto"],cancelado:[],devuelto:[]},I=["pendiente","confirmado","en_preparacion","enviado","entregado"];function Oo({onNavigate:s}){var K,q,V,Q,Z,ee,oe,te,re,ne;const[n,l]=c.useState([]),[z,U]=c.useState(!0),[k,me]=c.useState(""),[x,Y]=c.useState(""),[P,fe]=c.useState(""),[be,ye]=c.useState([]),[je,ve]=c.useState([]),[Ce,Ee]=c.useState([]),[Se,Fe]=c.useState([]),[r,C]=c.useState(null),[_e,E]=c.useState(!1),[A,M]=c.useState(!1),G=()=>({cliente_persona_id:"",cliente_org_id:"",metodo_pago_id:"",metodo_envio_id:"",descuento:0,impuestos:0,notas:"",direccion_envio:{calle:"",ciudad:"",departamento:"",pais:"Uruguay",cp:""},items:[{nombre:"",cantidad:1,precio_unitario:0,subtotal:0}]}),[d,p]=c.useState(G()),v=c.useCallback(async()=>{U(!0);try{const o=await no({estado:x||void 0,estado_pago:P||void 0,search:k||void 0});l(o)}catch(o){console.error("Error cargando pedidos:",o),m.error("Error al cargar pedidos")}finally{U(!1)}},[x,P,k]),Be=c.useCallback(async()=>{try{const[o,t,i,a]=await Promise.all([Le({activo:!0}),Oe({activo:!0}),Ue({activo:!0}),Ye({activo:!0})]);ye(o),ve(t),Ee(i),Fe(a)}catch(o){console.error("Error cargando opciones:",o)}},[]);c.useEffect(()=>{v()},[v]);const S=c.useMemo(()=>{const o=n.length,t=n.filter(u=>u.estado==="pendiente").length,i=n.filter(u=>["confirmado","en_preparacion","enviado"].includes(u.estado)).length,a=n.filter(u=>u.estado==="entregado").length,g=n.reduce((u,F)=>u+(F.total??0),0);return{total:o,pendiente:t,enCurso:i,entregado:a,facturado:g}},[n]),we=c.useMemo(()=>I.reduce((o,t)=>({...o,[t]:n.filter(i=>i.estado===t).length}),{}),[n]),D=(o,t,i)=>{p(a=>{const g=[...a.items];return g[o]={...g[o],[t]:i},(t==="cantidad"||t==="precio_unitario")&&(g[o].subtotal=g[o].cantidad*g[o].precio_unitario),{...a,items:g}})},ze=()=>p(o=>({...o,items:[...o.items,{nombre:"",cantidad:1,precio_unitario:0,subtotal:0}]})),ke=o=>p(t=>({...t,items:t.items.filter((i,a)=>a!==o)})),H=d.items.reduce((o,t)=>o+t.subtotal,0),X=H-d.descuento+d.impuestos,Pe=async()=>{if(!d.cliente_persona_id&&!d.cliente_org_id){m.error("Seleccioná un cliente");return}if(d.items.some(o=>!o.nombre)){m.error("Todos los ítems deben tener nombre");return}M(!0);try{const o={...d,cliente_persona_id:d.cliente_persona_id||null,cliente_org_id:d.cliente_org_id||null,metodo_pago_id:d.metodo_pago_id||null,metodo_envio_id:d.metodo_envio_id||null,subtotal:H,total:X,items:d.items},t=await io(o);if(!t)throw new Error("No se pudo crear el pedido");m.success(`Pedido ${t.numero_pedido} creado`),E(!1),v()}catch(o){console.error("Error creando pedido:",o),m.error(`Error: ${o instanceof Error?o.message:o}`)}finally{M(!1)}},Ae=async(o,t)=>{var i;try{if(!await so(o.id,t))throw new Error("No se pudo actualizar el estado");m.success(`Pedido → ${(i=b[t])==null?void 0:i.label}`),v(),(r==null?void 0:r.id)===o.id&&C({...r,estado:t})}catch(a){m.error(`Error: ${a instanceof Error?a.message:a}`)}},De=async(o,t)=>{var i;try{if(!await lo(o.id,t))throw new Error("No se pudo actualizar el estado de pago");m.success(`Pago → ${(i=y[t])==null?void 0:i.label}`),v(),(r==null?void 0:r.id)===o.id&&C({...r,estado_pago:t})}catch(a){m.error(`Error: ${a instanceof Error?a.message:a}`)}},J=o=>o.cliente_persona?`${o.cliente_persona.nombre} ${o.cliente_persona.apellido??""}`.trim():o.cliente_org?o.cliente_org.nombre:"—";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[e.jsx(We,{icon:T,title:"Pedidos",subtitle:"Gestión de órdenes, estados y pagos",actions:[{label:"+ Nuevo Pedido",primary:!0,onClick:()=>{Be(),p(G()),E(!0)}}]}),e.jsx("div",{style:{padding:"14px 28px",backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",gap:12,flexWrap:"wrap"},children:[{label:"Total pedidos",value:S.total,icon:T,color:f},{label:"Pendientes",value:S.pendiente,icon:xe,color:"#D97706"},{label:"En curso",value:S.enCurso,icon:ge,color:"#2563EB"},{label:"Entregados",value:S.entregado,icon:N,color:"#059669"},{label:"Facturado",value:`$${S.facturado.toLocaleString("es-UY")}`,icon:Me,color:"#7C3AED"}].map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 14px",backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB"},children:[e.jsx("div",{style:{width:34,height:34,borderRadius:8,backgroundColor:o.color+"18",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(o.icon,{size:16,color:o.color})}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontSize:"1.1rem",fontWeight:800,color:"#111827",lineHeight:1},children:o.value}),e.jsx("p",{style:{margin:0,fontSize:"0.7rem",color:"#6B7280"},children:o.label})]})]},o.label))}),e.jsxs("div",{style:{padding:"12px 28px",backgroundColor:"#FAFAFA",borderBottom:"1px solid #E5E7EB",display:"flex",gap:8,alignItems:"center",overflowX:"auto"},children:[I.map((o,t)=>{const i=b[o],a=we[o]??0;return e.jsxs(Re.Fragment,{children:[e.jsxs("button",{onClick:()=>Y(x===o?"":o),style:{display:"flex",alignItems:"center",gap:7,padding:"6px 14px",borderRadius:20,border:"1.5px solid",borderColor:x===o?i.color:"#E5E7EB",backgroundColor:x===o?i.bg:"#fff",color:i.color,cursor:"pointer",whiteSpace:"nowrap",fontWeight:x===o?700:500,fontSize:"0.8rem",transition:"all 0.15s"},children:[e.jsx(i.icon,{size:13}),i.label,e.jsx("span",{style:{fontWeight:800,fontSize:"0.85rem"},children:a})]}),t<I.length-1&&e.jsx(Xe,{size:14,color:"#D1D5DB",style:{flexShrink:0}})]},o)}),e.jsx("div",{style:{width:1,height:24,backgroundColor:"#E5E7EB",margin:"0 4px"}}),["cancelado","devuelto"].map(o=>{const t=b[o],i=n.filter(a=>a.estado===o).length;return e.jsxs("button",{onClick:()=>Y(x===o?"":o),style:{display:"flex",alignItems:"center",gap:7,padding:"6px 14px",borderRadius:20,border:"1.5px solid",borderColor:x===o?t.color:"#E5E7EB",backgroundColor:x===o?t.bg:"#fff",color:t.color,cursor:"pointer",whiteSpace:"nowrap",fontWeight:x===o?700:500,fontSize:"0.8rem"},children:[e.jsx(t.icon,{size:13}),t.label," ",i>0&&e.jsx("span",{style:{fontWeight:800},children:i})]},o)})]}),e.jsxs("div",{style:{padding:"10px 28px",backgroundColor:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",gap:10,alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:200},children:[e.jsx(Ie,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9CA3AF"}}),e.jsx("input",{value:k,onChange:o=>me(o.target.value),onKeyDown:o=>o.key==="Enter"&&v(),placeholder:"Buscar por nº de pedido…",style:{width:"100%",paddingLeft:30,paddingRight:12,height:34,border:"1.5px solid #E5E7EB",borderRadius:8,fontSize:"0.84rem",outline:"none",boxSizing:"border-box"}})]}),e.jsxs("select",{value:P,onChange:o=>fe(o.target.value),style:po,children:[e.jsx("option",{value:"",children:"Todos los pagos"}),Object.entries(y).map(([o,t])=>e.jsx("option",{value:o,children:t.label},o))]}),e.jsx("button",{onClick:v,style:{height:34,width:34,border:"1.5px solid #E5E7EB",borderRadius:8,background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ue,{size:14,color:"#6B7280"})})]}),e.jsx("div",{style:{flex:1,overflow:"auto",padding:"20px 28px"},children:z?e.jsx(ao,{text:"Cargando pedidos…"}):n.length===0?e.jsx(co,{icon:T,title:"No hay pedidos aún",sub:'Creá el primero con "+ Nuevo Pedido"'}):e.jsx("div",{style:{backgroundColor:"#fff",borderRadius:12,border:"1px solid #E5E7EB",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{backgroundColor:"#F9FAFB",borderBottom:"1px solid #E5E7EB"},children:["N° Pedido","Cliente","Items","Total","Estado","Pago","Fecha",""].map(o=>e.jsx("th",{style:{padding:"11px 14px",textAlign:"left",fontWeight:600,color:"#374151",whiteSpace:"nowrap",fontSize:"0.8rem"},children:o},o))})}),e.jsx("tbody",{children:n.map((o,t)=>{var g,u,F;const i=b[o.estado]??b.pendiente,a=y[o.estado_pago]??y.pendiente;return e.jsxs("tr",{style:{borderBottom:t<n.length-1?"1px solid #F3F4F6":"none",cursor:"pointer"},onMouseEnter:R=>R.currentTarget.style.backgroundColor="#FAFAFA",onMouseLeave:R=>R.currentTarget.style.backgroundColor="",onClick:()=>C(o),children:[e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontWeight:700,color:f,fontSize:"0.84rem",fontFamily:"monospace"},children:o.numero_pedido})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:30,height:30,borderRadius:"50%",backgroundColor:o.cliente_persona?"#FFF7ED":"#EDE9FE",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:o.cliente_persona?e.jsx(ie,{size:14,color:f}):e.jsx(Je,{size:14,color:"#8B5CF6"})}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontWeight:600,color:"#111827",fontSize:"0.84rem"},children:J(o)}),((g=o.cliente_persona)==null?void 0:g.email)&&e.jsx("p",{style:{margin:0,fontSize:"0.72rem",color:"#9CA3AF"},children:o.cliente_persona.email})]})]})}),e.jsxs("td",{style:{padding:"12px 14px",color:"#6B7280",fontSize:"0.8rem"},children:[((u=o.items)==null?void 0:u.length)??0," ítem",(((F=o.items)==null?void 0:F.length)??0)!==1?"s":""]}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsxs("span",{style:{fontWeight:700,color:"#111827",fontSize:"0.9rem"},children:["$",(o.total??0).toLocaleString("es-UY")]})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:"0.76rem",fontWeight:700,backgroundColor:i.bg,color:i.color,padding:"3px 10px",borderRadius:20,whiteSpace:"nowrap"},children:i.label})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:"0.76rem",fontWeight:600,backgroundColor:a.bg,color:a.color,padding:"3px 10px",borderRadius:20,whiteSpace:"nowrap"},children:a.label})}),e.jsx("td",{style:{padding:"12px 14px",color:"#9CA3AF",fontSize:"0.78rem",whiteSpace:"nowrap"},children:new Date(o.created_at).toLocaleDateString("es-UY")}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("div",{style:{width:28,height:28,borderRadius:6,backgroundColor:"#F3F4F6",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ke,{size:13,color:"#6B7280"})})})]},o.id)})})]})})}),r&&e.jsx("div",{style:ae,onClick:()=>C(null),children:e.jsxs("div",{style:{...de,maxWidth:680},onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{style:ce,children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0,fontSize:"1.05rem",fontWeight:700,color:"#111827"},children:["Pedido ",e.jsx("span",{style:{color:f,fontFamily:"monospace"},children:r.numero_pedido})]}),e.jsx("p",{style:{margin:"2px 0 0",fontSize:"0.76rem",color:"#9CA3AF"},children:new Date(r.created_at).toLocaleString("es-UY")})]}),e.jsx("button",{onClick:()=>C(null),style:pe,children:e.jsx(se,{size:18})})]}),e.jsxs("div",{style:{padding:"20px 24px",overflowY:"auto",maxHeight:"calc(90vh - 140px)",display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{style:{padding:14,backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB"},children:[e.jsx("p",{style:W,children:"Estado del pedido"}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:8},children:[(le[r.estado]??[]).map(o=>{const t=b[o];return e.jsxs("button",{onClick:()=>Ae(r,o),style:{padding:"5px 12px",borderRadius:8,border:`1.5px solid ${t.color}`,backgroundColor:t.bg,color:t.color,cursor:"pointer",fontSize:"0.78rem",fontWeight:700},children:["→ ",t.label]},o)}),(le[r.estado]??[]).length===0&&e.jsx("span",{style:{fontSize:"0.78rem",color:"#9CA3AF"},children:"Sin transiciones disponibles"})]}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:700,backgroundColor:(K=b[r.estado])==null?void 0:K.bg,color:(q=b[r.estado])==null?void 0:q.color,padding:"3px 10px",borderRadius:20},children:["Actual: ",(V=b[r.estado])==null?void 0:V.label]})})]}),e.jsxs("div",{style:{padding:14,backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB"},children:[e.jsx("p",{style:W,children:"Estado de pago"}),e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:8},children:Object.keys(y).filter(o=>o!==r.estado_pago).map(o=>{const t=y[o];return e.jsx("button",{onClick:()=>De(r,o),style:{padding:"5px 12px",borderRadius:8,border:`1.5px solid ${t.color}`,backgroundColor:t.bg,color:t.color,cursor:"pointer",fontSize:"0.78rem",fontWeight:600},children:t.label},o)})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:700,backgroundColor:(Q=y[r.estado_pago])==null?void 0:Q.bg,color:(Z=y[r.estado_pago])==null?void 0:Z.color,padding:"3px 10px",borderRadius:20},children:["Actual: ",(ee=y[r.estado_pago])==null?void 0:ee.label]})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs(_,{icon:ie,label:"Cliente",color:"#3B82F6",children:[e.jsx("p",{style:B,children:J(r)}),((oe=r.cliente_persona)==null?void 0:oe.email)&&e.jsx("p",{style:$,children:r.cliente_persona.email}),((te=r.cliente_org)==null?void 0:te.tipo)&&e.jsx("p",{style:$,children:r.cliente_org.tipo})]}),e.jsxs(_,{icon:qe,label:"Pago / Envío",color:"#8B5CF6",children:[e.jsx("p",{style:B,children:((re=r.metodo_pago)==null?void 0:re.nombre)??e.jsx("span",{style:{color:"#D1D5DB"},children:"Sin método de pago"})}),e.jsx("p",{style:$,children:((ne=r.metodo_envio)==null?void 0:ne.nombre)??"Sin método de envío"})]})]}),r.direccion_envio&&Object.values(r.direccion_envio).some(o=>o)&&e.jsx(_,{icon:Ve,label:"Dirección de envío",color:"#059669",children:e.jsx("p",{style:B,children:[r.direccion_envio.calle,r.direccion_envio.ciudad,r.direccion_envio.departamento,r.direccion_envio.pais].filter(Boolean).join(", ")})}),e.jsxs("div",{children:[e.jsx("p",{style:W,children:"Ítems del pedido"}),e.jsx("div",{style:{backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB",overflow:"hidden",marginTop:8},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.84rem"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{borderBottom:"1px solid #E5E7EB"},children:["Producto","Cant.","Precio unit.","Subtotal"].map(o=>e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontWeight:600,color:"#374151",fontSize:"0.76rem"},children:o},o))})}),e.jsx("tbody",{children:(r.items??[]).map((o,t)=>{var i;return e.jsxs("tr",{style:{borderBottom:t<(((i=r.items)==null?void 0:i.length)??0)-1?"1px solid #F3F4F6":"none"},children:[e.jsx("td",{style:{padding:"8px 12px",color:"#111827",fontWeight:500},children:o.nombre}),e.jsx("td",{style:{padding:"8px 12px",color:"#6B7280"},children:o.cantidad}),e.jsxs("td",{style:{padding:"8px 12px",color:"#6B7280"},children:["$",(o.precio_unitario??0).toLocaleString("es-UY")]}),e.jsxs("td",{style:{padding:"8px 12px",fontWeight:700,color:"#111827"},children:["$",(o.subtotal??0).toLocaleString("es-UY")]})]},t)})})]})})]}),e.jsxs("div",{style:{backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB",padding:"14px 16px"},children:[[{label:"Subtotal",value:r.subtotal??0,bold:!1},{label:"Descuento",value:-(r.descuento??0),bold:!1,color:"#059669"},{label:"Impuestos",value:r.impuestos??0,bold:!1}].map(o=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6,fontSize:"0.84rem",color:o.color??"#6B7280"},children:[e.jsx("span",{children:o.label}),e.jsxs("span",{children:["$",o.value.toLocaleString("es-UY")]})]},o.label)),e.jsxs("div",{style:{borderTop:"1px solid #E5E7EB",paddingTop:8,marginTop:4,display:"flex",justifyContent:"space-between",fontWeight:800,fontSize:"1rem",color:"#111827"},children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{style:{color:f},children:["$",(r.total??0).toLocaleString("es-UY")]})]})]}),r.notas&&e.jsx(_,{icon:Qe,label:"Notas",color:"#6B7280",children:e.jsx("p",{style:B,children:r.notas})})]})]})}),_e&&e.jsx("div",{style:ae,onClick:()=>E(!1),children:e.jsxs("div",{style:{...de,maxWidth:660},onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{style:ce,children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.05rem",fontWeight:700,color:"#111827"},children:"Nuevo Pedido"}),e.jsx("p",{style:{margin:"2px 0 0",fontSize:"0.76rem",color:"#9CA3AF"},children:"Completá los datos del pedido"})]}),e.jsx("button",{onClick:()=>E(!1),style:pe,children:e.jsx(se,{size:18})})]}),e.jsxs("div",{style:{padding:"20px 24px",overflowY:"auto",maxHeight:"calc(90vh - 140px)",display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Persona cliente"}),e.jsxs("select",{value:d.cliente_persona_id,onChange:o=>p(t=>({...t,cliente_persona_id:o.target.value})),style:w,children:[e.jsx("option",{value:"",children:"— Sin persona —"}),be.map(o=>e.jsxs("option",{value:o.id,children:[o.nombre," ",o.apellido??""]},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Organización cliente"}),e.jsxs("select",{value:d.cliente_org_id,onChange:o=>p(t=>({...t,cliente_org_id:o.target.value})),style:w,children:[e.jsx("option",{value:"",children:"— Sin organización —"}),je.map(o=>e.jsx("option",{value:o.id,children:o.nombre},o.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Método de pago"}),e.jsxs("select",{value:d.metodo_pago_id,onChange:o=>p(t=>({...t,metodo_pago_id:o.target.value})),style:w,children:[e.jsx("option",{value:"",children:"— Sin método —"}),Ce.map(o=>e.jsx("option",{value:o.id,children:o.nombre},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Método de envío"}),e.jsxs("select",{value:d.metodo_envio_id,onChange:o=>p(t=>({...t,metodo_envio_id:o.target.value})),style:w,children:[e.jsx("option",{value:"",children:"— Sin envío —"}),Se.map(o=>e.jsxs("option",{value:o.id,children:[o.nombre," ($",o.precio,")"]},o.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Dirección de envío"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:8},children:[e.jsx("input",{value:d.direccion_envio.calle,onChange:o=>p(t=>({...t,direccion_envio:{...t.direccion_envio,calle:o.target.value}})),style:h,placeholder:"Calle y número"}),e.jsx("input",{value:d.direccion_envio.cp,onChange:o=>p(t=>({...t,direccion_envio:{...t.direccion_envio,cp:o.target.value}})),style:h,placeholder:"CP"}),e.jsx("input",{value:d.direccion_envio.ciudad,onChange:o=>p(t=>({...t,direccion_envio:{...t.direccion_envio,ciudad:o.target.value}})),style:h,placeholder:"Ciudad"}),e.jsx("input",{value:d.direccion_envio.departamento,onChange:o=>p(t=>({...t,direccion_envio:{...t.direccion_envio,departamento:o.target.value}})),style:h,placeholder:"Departamento"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsx("label",{style:j,children:"Ítems del pedido *"}),e.jsxs("button",{onClick:ze,style:{display:"flex",alignItems:"center",gap:4,padding:"4px 10px",borderRadius:6,border:`1.5px solid ${f}`,background:"#FFF7ED",color:f,cursor:"pointer",fontSize:"0.78rem",fontWeight:600},children:[e.jsx(Ze,{size:13})," Agregar ítem"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:d.items.map((o,t)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr auto",gap:8,alignItems:"center"},children:[e.jsx("input",{value:o.nombre,onChange:i=>D(t,"nombre",i.target.value),style:h,placeholder:"Nombre del producto"}),e.jsx("input",{type:"number",value:o.cantidad,onChange:i=>D(t,"cantidad",parseFloat(i.target.value)||0),style:h,placeholder:"Cant.",min:1}),e.jsx("input",{type:"number",value:o.precio_unitario,onChange:i=>D(t,"precio_unitario",parseFloat(i.target.value)||0),style:h,placeholder:"Precio",min:0}),e.jsx("button",{onClick:()=>ke(t),style:{width:32,height:32,borderRadius:6,border:"1.5px solid #FEE2E2",background:"#FFF5F5",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(eo,{size:13,color:"#DC2626"})})]},t))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Descuento ($)"}),e.jsx("input",{type:"number",value:d.descuento,onChange:o=>p(t=>({...t,descuento:parseFloat(o.target.value)||0})),style:h,min:0})]}),e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Impuestos ($)"}),e.jsx("input",{type:"number",value:d.impuestos,onChange:o=>p(t=>({...t,impuestos:parseFloat(o.target.value)||0})),style:h,min:0})]})]}),e.jsxs("div",{style:{backgroundColor:"#FFF7ED",borderRadius:10,border:`1.5px solid ${f}30`,padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.875rem",color:"#92400E",fontWeight:600},children:"Total del pedido"}),e.jsxs("span",{style:{fontSize:"1.25rem",fontWeight:900,color:f},children:["$",X.toLocaleString("es-UY")]})]}),e.jsxs("div",{children:[e.jsx("label",{style:j,children:"Notas internas"}),e.jsx("textarea",{value:d.notas,onChange:o=>p(t=>({...t,notas:o.target.value})),style:{...h,height:72,paddingTop:8,resize:"vertical"},placeholder:"Observaciones, instrucciones especiales…"})]})]}),e.jsxs("div",{style:{padding:"14px 24px",borderTop:"1px solid #E5E7EB",display:"flex",justifyContent:"flex-end",gap:10},children:[e.jsx("button",{onClick:()=>E(!1),style:go,children:"Cancelar"}),e.jsxs("button",{onClick:Pe,disabled:A,style:{...xo,opacity:A?.7:1},children:[e.jsx(oo,{size:14})," ",A?"Guardando…":"Crear pedido"]})]})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}function ao({text:s}){return e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:200,color:"#9CA3AF"},children:[e.jsx(ue,{size:18,style:{animation:"spin 1s linear infinite",marginRight:8}})," ",s]})}function co({icon:s,title:n,sub:l}){return e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#9CA3AF"},children:[e.jsx(s,{size:44,style:{marginBottom:12,opacity:.25}}),e.jsx("p",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:n}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:6},children:l})]})}function _({icon:s,label:n,color:l,children:z}){return e.jsxs("div",{style:{padding:14,backgroundColor:"#F9FAFB",borderRadius:10,border:"1px solid #E5E7EB"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[e.jsx("div",{style:{width:22,height:22,borderRadius:5,backgroundColor:l+"20",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(s,{size:12,color:l})}),e.jsx("p",{style:{margin:0,fontSize:"0.72rem",fontWeight:700,color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.06em"},children:n})]}),z]})}const ae={position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:20},de={backgroundColor:"#fff",borderRadius:16,width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.25)",maxHeight:"90vh",display:"flex",flexDirection:"column"},ce={padding:"18px 24px",borderBottom:"1px solid #E5E7EB",display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexShrink:0},pe={background:"none",border:"none",cursor:"pointer",color:"#9CA3AF",padding:4},W={margin:0,fontSize:"0.72rem",fontWeight:700,color:"#9CA3AF",textTransform:"uppercase",letterSpacing:"0.06em"},B={margin:0,fontSize:"0.875rem",fontWeight:600,color:"#111827"},$={margin:"2px 0 0",fontSize:"0.76rem",color:"#6B7280"},j={display:"block",fontSize:"0.8rem",fontWeight:600,color:"#374151",marginBottom:5},h={width:"100%",height:36,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.84rem",color:"#111827",outline:"none",boxSizing:"border-box"},po={height:34,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.84rem",color:"#374151",cursor:"pointer",backgroundColor:"#fff"},w={width:"100%",height:36,border:"1.5px solid #E5E7EB",borderRadius:8,padding:"0 10px",fontSize:"0.84rem",color:"#374151",cursor:"pointer",outline:"none",boxSizing:"border-box"},go={padding:"9px 20px",borderRadius:8,border:"1.5px solid #E5E7EB",background:"#fff",cursor:"pointer",fontSize:"0.875rem",fontWeight:600,color:"#374151"},xo={padding:"9px 22px",borderRadius:8,border:"none",backgroundColor:"#FF6835",color:"#fff",cursor:"pointer",fontSize:"0.875rem",fontWeight:700,display:"flex",alignItems:"center",gap:6};export{Oo as PedidosView};
